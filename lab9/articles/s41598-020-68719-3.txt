Evolutionary algorithms converge towards evolved biological photonic structures
Nature features a plethora of extraordinary photonic architectures that have been optimized through natural evolution in order to more efficiently reflect, absorb or scatter light. While numerical optimization is increasingly and successfully used in photonics, it has yet to replicate any of these complex naturally occurring structures. Using evolutionary algorithms inspired by natural evolution and performing particular optimizations (maximize reflection for a given wavelength, for a broad range of wavelength or maximize the scattering of light), we have retrieved the most stereotypical natural photonic structures. Whether those structures are Bragg mirrors, chirped dielectric mirrors or the gratings on top of Morpho butterfly wings, our results indicate how such regular structures might have spontaneously emerged in nature and to which precise optical or fabrication constraints they respond. Comparing algorithms show that recombination between individuals, inspired by sexual reproduction, confers a clear advantage that can be linked to the fact that photonic structures are fundamentally modular: each part of the structure has a role which can be understood almost independently from the rest. Such an in silico evolution also suggests original and elegant solutions to practical problems, as illustrated by the design of counter-intuitive anti-reflective coatings for solar cells.
Nature features a diversity of photonic architectures producing the most vivid optical effects1,2,3. Regularly alternating chitin and melanin layers constitutes, for instance, a very efficient way to reflect light, giving the structure a colored metallic appearance. Such structures can be found on the cuticle of many insects, including common flies (e.g. Lucilia sericata) or beetles (e.g. Chrysolina americana or Asphidomorpha tecta). These ubiquitous structures have been optimized through natural evolution during millions of years, which suggests that they provide an evolutionary advantage to all the animals. While such dielectric, multilayered mirrors4 are relatively simple, more complicated architectures can be found in many animals. Most famous are probably the nano-sized christmas-tree-like ridge structure of Morpho butterfly wing scales5,6. These nano-sized christmas-trees, assembled of transparent chitin, are responsible for the bright iridescent blue color of the Morpho rethenor wings which has made the butterfly so famous.
Numerical optimization has been extensively used in photonics for the last decades, especially in the context of optical filters7,8 for their technological importance—the multiplexers used to increase the bandwidth of optical fibers rely on such multilayered structures. By ‘simply’ choosing the thicknesses of transparent layers with alternating refractive index (RI), it is possible to design and manufacture virtually any kind of optical filter9. Efficient algorithms have been developed to solve precisely this kind of inverse problem: finding the right geometrical (thicknesses) and optical (RI) parameters of the structure to obtain the desired optical response. With the development of more versatile simulations tools in optics and the increase in the available computational power10, numerical optimization has been applied to more complicated problems, producing complex designs with interesting performances11,12,13,14,15. However, we underline that the most successful approaches to date9,15 do not rely on standard global optimization techniques. Attempts using early genetic or specifically designed algorithms16,17,18 did not provide sufficiently efficient designs to warrant their further use. Finally, except for one remarkable case where some regularity seemed to spontaneously emerge19, none of the structures obtained by numerical optimization seem to possess the regularity of natural structures15. Given the fundamental differences between naturally occurring structures and artificially optimized designs, there is still a knowledge gap as to why natural structures are regular or periodical in a seemingly different way than the fabricated ‘ideal’ structures and whether such a regularity is imposed for optical reasons.



Suspecting these structures occur mainly for optical reasons19, we here apply state-of-the-art evolutionary algorithms to problems of increasing complexity. We show that solutions that resemble natural photonic architectures can be retrieved with this class of algorithms. Each problem we study is defined by a quantity to minimize or maximize, like the reflectance or the scattering, and constraints, for instance on the values of the refractive index of the materials. Changing constraints make specific features emerge which are present in natural architectures, thus allowing to understand their role precisely. Furthermore, we show then how this method can be applied to key problems in the optical sciences, e.g. enhancing the absorption of light in solar cells, to generate regular and understandable devices.
To perform the optimizations, we have employed five different, state-of-the-art algorithms20,21,22,23,24 that seem to be best suited for our setting, i.e. complex real-world problems for which little is known a priori from a mathematical point of view. Evolutionary algorithms20,21,22,23,24 are computational trial-and-error algorithms that aim at finding optimal solutions to well posed mathematical problems while being inspired by evolutionary processes. In general, evolutionary algorithms consider a population of individuals, where each individual corresponds to a potential solution with well defined geometrical and optical parameters. An objective function allows to rate the fitness of a solution/individual: the lower the objective function, the better the solution and thus the “fitter” the corresponding individual. The population then evolves: while individuals that are not “fit” enough and present too high an objective function value are eliminated, new individuals are subsequently created, for example by combining the geometrical and optical characteristics of better individuals. Through this in silico evolution, the average fitness of the individuals increases and hopefully leads to the best possible solution to the problem posed, the so-called optimal solution that minimizes the objective function.
The algorithms differ in their original inspiration (see Supplementary Information for more details). The first (\(1+1-{\text {ES}}\)) is inspired by the evolution of bacteria, with local mutations taking a central place24; the second (Differential Evolution21) is (remotely) inspired by the evolution process of sexual selection and includes recombination between successful individuals; the last ones are less related to evolution. Particle Swarm Optimization22 is inspired by the behavior of swarms, while Covariance Matrix Adaptation and Nelder–Mead20 are more artificial algorithms based on profound mathematical considerations. All of them can be considered as global optimization methods, aiming at finding the true optimal solution in the whole landscape. This is not the case for gradient-based methods, which have spread recently in the photonics community15 and which are considered local—they start with an arbitrary solution and improve it as far as possible, and are thus not meant to find the global optimum.
To investigate the evolutionary optimization of photonic structures, we have applied different algorithms. Their performances significantly differed. Each algorithm was given the same budget of \(10^4\) evaluations of the objective function, which is enough for each algorithm to converge towards a solution. In order to evaluate how reliable each algorithm is, we have run 100 optimizations for each algorithm (see Fig. 3). Whether multilayered or more complex structures are considered, the most widespread variant of Differential Evolution (DE) consistently outperforms the others including non-evolutionary algorithms, as shown on Fig. 3 (see Supplementary Information for the complete results). This algorithm is the only one that is inspired by sexual evolution, where recombination (by crossover rather than by averaging) between individuals plays a central role. At each generation, an individual generates an offspring that replaces its parent only if it is “fitter”. A characteristic of a parent (like the thickness of a given layer, or the width of a block) has one in two chances to be transferred directly to the offspring. Otherwise, this characteristic will take a value computed by mixing the characteristics of four individuals: the parent, two randomly chosen individuals and the best individual so far (see Supplementary Information).
In more classical numerical problems used to compare optimization algorithms, DE does not necessarily fare better—we attribute this discrepancy to the fact that the physical problems considered here are modular: each part of the structure, even if it interacts with the rest of the architecture, has a precise purpose that can be optimized partially independently. DE presents features that help in such a situation, namely combining exact copies of some variables and new variables from other individuals.
We first discuss here what the typical dimension of a photonic problem should be to be tackled with our method (from 5 to 40 dimension typically).
Our results do not imply that DE is the best choice for an arbitrary photonic problem. To perform well, the problem and its most efficient solutions have to be modular. If it makes little sense to optimize a part of the structure almost independently of the rest, the advantage of DE will not play out. Recent results41 show that for some problems in photonics with a low number of dimensions, DE is in fact among the worst possible choices. We insist that DE is more relevant for modular design problems, which implies a relatively large number of parameters (more than 5 typically). Obviously, as exemplified above, a large number of problems in photonics are modular, but not all design problems may be7.
Optimization problems in photonics are generally difficult as the structures are resonant. In an optical filter, for example, each layer may resonate for various frequencies, and such resonances may enhance transmission or reflection for a given wavelength. As a result, even a relatively simple photonics problem presents a number of local minima for the objective function, i.e. solutions which are locally optimal and which would require a large change to be improved further. This issue is difficult to tackle even for a global optimization algorithm and almost impossible for a local optimization algorithm42. As the dimension of the problem increases, the likelihood for a global algorithm to get stuck in a local minimum increases significantly: in this work, above 40 parameters, the algorithms may not be very reliable, even for DE in the most modular cases.
Finally, since there is no way to be sure a solution produced by optimization is truly optimal42, these have to be taken with care. One in particularly always has to question whether the solutions are regular because they are optimal or whether the are produced because regular solutions are easier to find. We note however that all the regular structures we have generated in this work proved to be the best solutions that could be generated in a very consistent way. Moreover, very similar solutions were produced when we gradually increased the complexity of each problem—which is a way to reinforce the confidence one can have in the generated designs. As is shown in more detail in the Supplementary Information, for a given number of degrees of freedom either the algorithms provided a regular solution which could not be beaten by any disordered structure, or no regular solution was produced at all and the algorithms ceased to be reliable (thus producing structures with a higher objective function than for a smaller number of dimensions for instance). It has been noted in a previous work19 that “periodicity is a principal condition for effective control of the distribution of light”. We strongly agree and hypothesize that in photonics, regularity should be considered a sign that a structure is close to optimality. Many disordered structures have probably emerged in previous works16 because the problem was simply too difficult for the algorithms.
We underline that many other problems in the optical science and related fields could benefit from such an evolutionary optimisation approach, all the more so that DE is a very simple algorithm that requires only a few lines of code. We have, for example, compared DE to the Needle algorithm for the design of optical filters7,8. This algorithm produces extremely efficient optical filters by adding layers to the structure to improve their performance. No other algorithm has produced better designs so reliably—thus making Needle a reference technique even though the designs are known not to be optimal9. In the test case of the high reflectance dielectric mirror resembling the dielectric mirror above7, DE was able to produce a better design (see Supplementary Information) suggesting it may compete with Needle on the most modular problems as long as the number of layer is kept low enough for DE to provide satisfactory solutions (typically under 40, see above).
Recently, topological optimization has attracted a lot of interest in the photonics community15. The general idea is to consider a problem with very little constraints on the geometry and thus a very large number of parameters. One then improves gradually the structure because the gradient of the objective function (and thus the general direction in which the performances improve) can be very easily computed in the case of a photonic problem15. Such a technique has proven extremely successful in mechanics, to the point that global optimization methods appear useless43. The structures produced by the optimization are regular and understandable. In photonics, because of the numerous local minima due to optical resonances (see “Discussion” above), the technique has not produced results that are similarly convincing. Generally, topological optimization generates regular structures only when periodicity or symmetry is assumed and when the starting point is already periodical (like a photonic crystal or gratings44). Often, some kind of regularization is performed to avoid the apparition of extremely small features. Some works use several of these techniques combined to obtain efficient and regular designs45. Without such steps, the methods do generate quite high-performing, but very often disordered, results that include extremely small features—thus requiring fabrication techniques which makes their commercialization unlikely15. This can be understood because topological optimization is inherently a steepest descent which is more likely to be stuck in one of the numerous local minima of the problem, something which does not happen in mechanics43. However, even if a physical analysis may lead to the conclusion that the design is not fully optimal46, the structures produced present excellent performance11,12. We underline that the choice of the starting point for the algorithm is always a delicate question11.
It may be difficult or even impossible to compare a global approach to a topological optimization approach. Our approach, since it does not produce satisfactory results for a very high number of dimensions, requires additional constraints on the geometry. In the case of the Morpho butterfly structure, we assumed a geometry composed as blocks and were able to retrieve multilayered structures (see Fig. 3). For this, we needed to limit the number of degrees of freedom for the algorithms and thus potentially introduced some bias. It remains to be seen if our global approach, which requires a lot of evaluations of the objective function, will be able to generate 3D structures with comparable performances, when more degrees of freedom will be needed. One could however imagine to combine these approaches in the future to benefit from their respective strengths.
We use the following evolutionary and non-evolutionary optimization methods: Nelder–Mead (NM20), Particle Swarm Optimization (PSO22), Differential Evolution (DE21), Covariance Matrix Adaptation (CMA23), One-plus-one Evolution Strategy(OPO24). NM (a.k.a. simplex) is not evolutionary; it is based on averaging and symmetrizing, and is considered as a fast mathematical programming solution for unreliable gradients. CMA is “half” evolutionary; it uses selection of the best, but also statistics on the global population for guiding mutations; it outperforms most mathematical programming methods and evolutionary algorithms on a wide range of artificial testbeds50,51. PSO adds non-biological inertial forces to evolution, leading to improved rates on at least partially separable functions. OPO is evolutionary, very simple, with blind mutations, but no recombination; it works quite well on simple problems with good conditioning. DE is the most evolutionary of these methods for various criteria: it has recombination (contrarily to OPO), this recombination is coordinate-wise so that we can modify different parts of the genome selectively (only tested algorithm with this property), and recombination a limited number of parents (contrarily to CMA). DE is recommended for real world problems involving modularity52, which matches our setting and biological settings.
The objective function are evaluated using either a freely available scattering matrix method25 for the computation of the optical properties of multilayers (reflection or absorption and short-circuit current for photovoltaic structures). In that case, we simply note \(r(\lambda )\) the reflection coefficient at a wavelength \(\lambda \). For the Morpho structures we use a Fourier Modal Method38,39 to compute the power distribution in the different diffraction orders. We note \(r_i(\lambda )\) the amplitude of the i-th diffraction order in reflection at a wavelength \(\lambda \).
The objective functions are (i) \(1-r(\lambda _0)\) where \(\lambda _0\) is the working wavelength to retrieve the Bragg mirror (ii) \(1-\frac{1}{N}\sum _{n=0}^7 r(500+50\times n)\) (i.e. one minus the mean reflection coefficient for fifty equidistant values of the wavelength from 500 nm to 800 nm) to retrieve the chirped dielectric mirror (iii) \(1-\frac{1}{2}(r_{+1}(450)+r_{-1}(450)-r_0(450))+\frac{1}{N}\sum _{i=1}^N r_0(\lambda _i)+\frac{a}{n_{b}}\sum _{j=1}^{n_{b}} \frac{w_j}{d}\) to retrieve Morpho-like structures, where \(n_b\) is the number of blocks allowed, a is the constraint put on the weight of the structure (\(a=0\) to get the optical optimum, \(a=0.5\) to retrieve architectures similar to Morpho and \(w_j\) the width of the j-th block) and the \(\lambda _i\) are \(N=8\) wavelength evenly distributed in the spectrum (iv) \(1-\eta \) where \(\eta \) is the conversion efficiency for the photovoltaic device defined as the ratio of the short-current circuit (assuming a quantum yield of one and a AM1.5 solar spectrum) to the maximum short-circuit current achievable for the spectral range considered (from 375 to 750 nm).
We underline that the codes we have used, including the Fourier Modal Method, are now part of the open Nevergrad library47, so that they can be downloaded freely.
