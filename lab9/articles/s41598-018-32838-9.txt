One-out-of-two Quantum Oblivious Transfer based on Nonorthogonal States
This research proposes the first one-out-of-two quantum oblivious transfer (QOT) scheme that does not have a two-level structure and is not subject to Lo’s no-go theorem. Instead, the proposed scheme is a simple and efficient approach based on nonorthogonal states. The nonorthogonality causes one of a pair of messages to be unable to be measured to achieve the irreversible goal of discarding a message, resulting in a one-out-of-two selection effect. The proposed QOT protocol is therefore built directly on quantum resources rather than on a two-level structure in which two classical keys must first be created using quantum resources (all-or-nothing QOT) and then a one-out-of-two protocol is built from there. Furthermore, the proposed protocol allows Alice and Bob to test each other’s loyalty by comparing measurement results. In addition, the relationship with the no-go theorem is discussed in detail; this relationship is often overlooked in other studies. A security analysis demonstrates that the proposed protocol is secure against both external and internal attacks. In addition, an efficiency analysis shows that the proposed protocol is more efficient than other, two-level-structured protocols.
Oblivious transfer (OT) is an important branch of cryptography with many useful and important applications, such as secure computation, bit commitment, remote coin-flipping, and digital contract signing, for which OT protocols are the cryptographic primitives. The two most commonly used OT protocols are the all-or-nothing protocol and the one-out-of-two protocol. All-or-nothing OT was first introduced by Rabin1 in 1981. In the all-or-nothing OT protocol, a sender Alice wants to send a secret message, m ∈ {0, 1}, to a receiver Bob who has only a 50% probability of receiving m. He will either learn the message m with 100% reliability or learn nothing about m. At the end of all-or-nothing OT, Alice remains oblivious as to whether Bob received the message m. Following the proposal of this protocol, Even et al.2 presented one-out-of-two OT (or it can be abbreviated as 1–2 OT), in which Alice transfers two messages, m0 and m1, to Bob, and he can choose only one of them and will have no idea what the other message is. When the one-out-of-two OT protocol is complete, Alice learns nothing about which message Bob selected. In 1988, Crépeau3 presented a method for building a one-out-of-two OT protocol by using p-all-or-nothing OT, in which the receiver has a probability p of receiving the message m, called Crépeau’s reduction. The receiver builds two key sets to represent his choice, key0 and key1, one of which he learns with 100% certainty and the other of which he learns with 0% certainty. Based on Bob’s choice j ∈ {0, 1}, he asks Alice to encrypt her messages m0 and m1 using keyj and \(ke{y}_{\bar{j}}\), where \(j=0\Rightarrow ke{y}_{0}\) or \(j=1\Rightarrow ke{y}_{1}\). Then, Bob can receive mj under this two-level-structured method.
Classical OT protocols are almost all based on the RSA cryptosystem4. However, Shor showed that a quantum algorithm5 can be used to break the RSA cryptosystem in polynomial time, which means that such protocols may be unsafe against quantum algorithms. In 1984, Bennett and Brassard proposed the first quantum key distribution protocol6, called BB84, thereby initiating the study of quantum cryptography. Researchers later showed that BB84 is unconditionally secure7,8,9,10 both in theory and in implementation by achieving a one-time pad. The security of quantum cryptography is based on physical laws, unlike that of classical cryptography, which is based on mathematical complexity. This physical basis allows quantum cryptography to easily achieve many goals that were difficult or unthinkable in the past, including unconditional security.
Since the proposal of BB846, researchers have been designing quantum oblivious transfer (QOT) protocols using quantum properties. Crépeau and Kilian11 proposed the first all-or-nothing QOT scheme in 1988, and Bennett et al.12 proposed the first one-out-of-two QOT scheme protected by a quantum error-correcting code in 1992. In 1994, Crépeau13 presented a one-out-of-two QOT scheme based on quantum bit commitment (QBC), which guarantees security under the assumption that Bob cannot delay the quantum measurement. In 1995, Yao14 further proved that this protocol is secure against coherent measurement if QBC is secure. However, in 1997, Lo15 doubted that all one-sided two-party computations (in which two parties must input i and j to calculate a function f(i, j) but only one of the two parties is allowed to learn the result) may be insecure, including one-out-of-two QOT (the function f in one-out-of-two QOT is a selector). This was called Lo’s no-go theorem, and because of the computational equivalent3,12 to two OTs, this theorem has caused extreme difficulties in the development of QOT research.
Recent studies have, however, proposed various methods of avoiding Lo’s no-go theorem. In 2002, Shimizu and Imoto16 presented an interesting communication method analogous to one-out-of-two QOT with a 50% probability of completing the communication. They17 then improved the security of their protocol against entangled pair attacks in 2003. Moreover, in 2006, He and Wang18 proposed a secure all-or-nothing QOT scheme using four entangled states, which, as a result, was no longer subject to Lo’s no-go theorem15. Consequently, He claimed that Lo’s no-go theorem15 did not truly cover all QOT conditions. Thereafter, He19 demonstrated that a one-out-of-two QOT scheme built on all-or-nothing QOT protocol using Crépeau’s reduction3 also is not subject to Lo’s no-go theorem15. The key is that the receiver inputs his choice before the sender inputs her messages m0 and m1, causing the functions f of the one-out-of-two protocol and Lo’s no-go theorem15 to be different.
Following He’s proof19, researchers have been designing new one-out-of-two QOT schemes19. In 2007, Wei Yang et al.20 presented a one-out-of-two QOT scheme using tripartite entangled states based on He’s proof19 and also showed that this scheme is not covered by the cheating strategy of Lo’s no-go theorem15. Li Yang21 presented an all-or-nothing QOT scheme using nonorthogonal states, similar to B9222, and used it as a basis for constructing a one-out-of-two QOT scheme in 2013. Subsequently, Yu-Guang Yang and his research team, as part of a research effort that began in 2014, have proposed several QOT protocols. They have been testing various schemes for building one-out-of-two QOT protocols using He’s proof19. In 2014, they23 proposed all-or-nothing and one-out-of-two QOT protocols based on an untrusted third party. In 2015, they24 developed an all-or-nothing QOT protocol by analyzing the probability of the qubit state distribution, which led them to propose a method of testing the loyalty of the sender and then to build a one-out-of-two QOT protocol on this basis. They25 also designed a one-out-of-two QOT scheme with a two-level structure using BB846 and reduced it to B9222 for an all-or-nothing QOT scheme. In addition, they26 attempted to use Bell states to achieve the same effect as B9222 for one-out-of-two QOT. Furthermore, in 2017, they27 proposed a method of using any two nonorthogonal states by cooperatively measuring the qubit sequence and then built a one-out-of-n QOT scheme using this method.
However, these protocols21,23,24,25,26,27 all have two-level structures, in which two classical keys are created using an all-or-nothing QOT protocol and then a one-out-of-two QOT protocol is built on top. The two-level structure is clearly inefficient, because many quantum resources are consumed for all-or-nothing QOT instead of being used to transfer the message. In addition, this structure reduces the elasticity and diversity of protocol design because such designs can only follow He’s proof19 with minor revisions to the details of the all-or-nothing QOT scheme. In our opinion, He’s proof19 not only revealed a different function f, which is not subject to Lo’s no-go theorem15, based on a two-level structure but also provided a new approach in the sense that if any protocol can achieve the same effect as that of f in He’s proof19, then it is also covered by He’s proof19. In this work, the first one-out-of-two QOT protocol is proposed that is directly based only on the properties of quantum resources, namely, nonorthogonal states, rather than a two-level structure, while also being covered by He’s proof19. The key to our protocol is that Bob’s choice is made before Alice inputs her messages m0 and m1. The property of nonorthogonality ensures that one of the two messages cannot be measured and thus maintains obliviousness, thereby achieving the same effect as that of f in He’s proof19. Therefore, our protocol is not only secure (and not subject to Lo’s no-go theorem) but can achieve greater efficiency than protocols21,23,24,25,26,27 that are based on a two-level structure.
This section consists of six subsections, including the preliminaries, the basic idea of our protocol, the proposed protocol itself, its relationship with Lo’s no-go theorem15 and He’s proof19, and its security and efficiency analyses. The preliminaries introduce the properties of quantum machines and define some notation. Then, the basic idea of the proposed protocol is introduced before the details of the protocol itself, which are described in the subsequent section. Moreover, the relationship among Lo’s no-go theorem15, He’s proof19 and the proposed protocol is discussed in the subsection titled “Resisting Lo’s cheating strategy15”. Finally, security and efficiency analyses are presented in the last two subsections.
This subsection introduces the basic definitions of concepts relevant to quantum machines, such as quantum bits, superposition, entanglement, gates, and operations, as well as some properties of quantum machines.
The classical information carrier is called a “bit”. The quantum information carrier is called a “quantum bit”, or a “qubit”. A qubit collapses to certain states of a basis when it is measured. Two bases are commonly used: the Z-basis and the X-basis. The Z-basis is defined as \(|0\rangle =(\begin{array}{c}1\\ 0\end{array})\) and \(|1\rangle =(\begin{array}{c}0\\ 1\end{array})\), and the X-basis is defined as \(|\,+\,\rangle =\frac{1}{\sqrt{2}}(\begin{array}{c}1\\ 1\end{array})=\frac{1}{\sqrt{2}}(|0\rangle +|1\rangle )\) and \(|\,-\,\rangle =\frac{1}{\sqrt{2}}(\begin{array}{c}1\\ -1\end{array})=\frac{1}{\sqrt{2}}(|0\rangle -|1\rangle )\). A basis is also an orthonormal set.
Superposition refers to the phenomenon that a qubit can simultaneously exist in both the |0〉 and |1〉 states; i.e., \(|\varphi \rangle =\alpha |0\rangle +\beta |1\rangle \), meaning that |ϕ〉 will collapse to |0〉 and |1〉 with probabilities of \({\Vert \alpha \Vert }^{2}\) and \({\Vert \beta \Vert }^{2}\), respectively. In addition, the state |−〉 is also considered to be a superposition in the Z-basis. It has a probability of \({\Vert \frac{1}{\sqrt{2}}\Vert }^{2}=\frac{1}{2}\) of collapsing to |0〉 and a probability of \({\Vert -\frac{1}{\sqrt{2}}\Vert }^{2}=\frac{1}{2}\) of collapsing to |1〉.
Another important property, entanglement is the phenomenon that qubits cannot exist singly. There are four common entangled states, called Bell states, as shown in Eq. 1. For example, when a state |Φ+〉 is measured, as in Eq. 1, the result may be either |00〉12 or |11〉12, where the subscript indicates the qubit order. As a result, in this case, it is possible to immediately learn the states of two qubits when only one is measured. Einstein referred to this as “spooky action at a distance”.
Moreover, unitary operations (UU* = U*U = I) are regarded as gates in quantum computers. There are four common operations, represented by operators called Pauli matrices, which are denoted by {I, X, Y, Z}, as shown in Eq. 2. Operations I and Z cannot be distinguished in the Z-basis, and Y and Z cannot be distinguished in the X-basis. A single qubit cannot be observed using all four operations, which means that some information is ignored; this is a key element of the proposed protocol. For example, after a Y gate, the state |0〉 becomes −|1〉; i.e., a result of |1〉 will be obtained when the qubit is measured. This negative amplitude is called a global phase and cannot be measured. Another important gate is the Hadamard gate, as described in Eq. 2, also called the H gate. The H gate can be used to convert between two different bases (the Z-basis and the X-basis). For example, after an H gate, the state |0〉 (|+〉) H becomes |+〉 (|0〉). Table 1 shows the states {|0〉, |1〉, |+〉, |−〉} after the Pauli operations {I, X, Y, Z}.
This subsection introduces the basic idea underlying encoding and decoding in the proposed protocol. In this study, the four operations “I”, “X”, “Y” and “Z” represent four messages “00”, “10”, “11” and “01”, respectively, for encoding. Each message can be mapped to m0 and m1, which represent Alice’s two messages. Because the properties of the two different bases (shown in Table 2) cause a negative amplitude to be unable to be measured (see the last final state in the left-hand part of Table 2), one of the two messages cannot be measured, and which one depends on the basis in which they are prepared (the receiver’s choice). For example, suppose that Bob prepares the state |0〉 and performs either I or H in accordance with his choice, j0 or j1, in order to learn the content of either m0 or m1, respectively. In this way, Bob inputs his choice first, and the initial state |0〉 will be either |0〉 or |+〉, depending on his choice. The results are shown in Table 2; after Alice’s operation, if Bob’s choice is j0 (his initial state is |0〉), he learns m0 unambiguously (the bold text in the left-hand part of Table 2); otherwise, he learns m1 (the bold text in the right-hand part of Table 2) unambiguously. As a result, one of the two messages is automatically discarded, thereby achieving the requirements of one-out-of-two QOT.
As seen from the basic idea presented above, the operations I and H can be regarded as representing Bob’s intentions regarding his choice; this makes the proposed protocol similar to B9222, which has been proven unconditionally secure both in theory and in implementation28,29, meaning that no one can perfectly identify all states of the qubits without any information from their creator. Another key property is that some operations cannot be distinguished in some bases, which means that it is not possible to identify all operations from a single qubit. The proposed protocol allows Alice and Bob to test each other’s loyalty, because they can check whether the initial and final states are correct. In other words, if they want to lie to each other, it will create errors, which can be discovered when they test each other. Let us give a simple example at the end of every step of the protocol without channel checking. The proposed protocol consists of 7 steps as follows:
Step 1. Bob creates a qubit sequence in accordance with his choice intentions j0 and j1, which correspond to the states |0〉 and |+〉, respectively. The necessary I and H gates can be considered as equivalent to his choice intentions in this stage. This sequence must be longer than the OT sequence, which contains all received message qubits as well as qubits for channel checking and for testing Bob’s loyalty. In addition, the channel checking and loyalty testing states are different; the former, also called decoy qubits, belong to {|0〉, |1〉, |+〉, |−〉}, and the latter belong to {|0〉, |+〉}. If N denotes the minimum length (at which Bob will receive N messages), M is the number of channel checking qubits, and K is the number of loyalty testing qubits, then the total length of the QOT sequence is N + M + 2K. Bob randomly prepares M qubits from {|0〉, |1〉, |+〉, |−〉} (each qubit is independent) and inserts them into his sequence. Subsequently, he also inserts his N and 2K candidate choice intentions ({|0〉, |+〉}) into his sequence and then sends the sequence to Alice. Let us give a simple example to describe the proposed one-out-of-two QOT protocol without channel checking, suppose that Bob prepares two qubits in |0+〉12 (N) to represent his choices and an additional two qubits in |0+〉34 (2K) for loyalty testing. He then sends these four qubits to Alice.
Step 2. Once she receives the sequence from Bob, Alice first checks the channel for an eavesdropper (Eve) and then tests Bob’s loyalty. First, she asks Bob to publish the bases and states that he has created. If the error rate is higher than a given threshold, then an Eve is present on the channel, and Alice and Bob abort their communication; otherwise, Alice goes on to test Bob’s loyalty. She discards the qubits for channel checking and then randomly selects several positions and requests that Bob publish his bases. If different results, i.e., ∉ {|0〉, |+〉}, are measured and the error rate is higher than the given error rate, then Bob is considered dishonest, and she aborts this communication; otherwise, she proceeds to the next step. Following the above example, once Alice receives the ordered sequence |0+0+〉1234, she randomly chooses a qubit for loyalty testing. Suppose that Alice’s random choice is qubit 4; then, she asks Bob to publish the basis of qubit 4, measures it, and compares the published and measured results. If the error rate is higher than the threshold, then Bob is considered as dishonest; after that, qubit 4 is discarded.
Step 3. Since the loyalty test may disturb the order of Bob’s choice intentions, Bob must ask Alice to reorder the qubits. It is for this purpose that 2K additional qubits are initially provided to prevent vacancies in the list of choice intentions. In this step, the sequence after reordering represents Bob’s real choices. Following the above example, after the loyalty test, Bob asks Alice to reorder the remaining qubits in the order 21, and the states become |+0〉21, with qubit 3 discarded. The resulting state |+0〉21 represents Bob’s choices, j1 and j0, respectively.
Step 4. Alice now inputs her secret messages m0 and m1 through the I, X, Y and Z operations, corresponding to the combinations “00”, “10”, “11” and “01”, respectively. Following the above example, Alice performs Z and X in accordance with her messages “0112” and “1034”, where the subscripts indicate Alice’s classical bit order, on qubits 2 and 1, respectively. This converts the state |+0〉21 into |−1〉21.
Step 5. Alice then randomly inserts decoy qubits from {|0〉, |1〉, |+〉, |−〉} into the sequence for channel checking and sends the sequence to Bob.
Step 6. When Bob receives the sequence from Alice, he asks Alice to publish the positions and states of the decoy qubits. If the error rate is higher than the channel error rate, they abort this communication and return to step 1. Otherwise, Bob learns the contents of the classical messages by measuring the qubits with the bases he prepared. Following the above example, Bob performs X- and Z-basis measurements to learn the second and first classical messages, “1” and “1” (0112 and 1034, where the subscripts indicate Alice’s classical bit order), respectively.
Step 7. At the end of this protocol, where Bob has to test Alice’s loyalty to prevent Alice from cheating, she can learn Bob’s choice with the probability 25%, or 29.3% by POVM. Bob chooses some random positions and asks Alice to publish her operations. Bob performs the operations according to Alice’s announcement, in order to recover those qubits into {|0〉, |+〉}. If the error rate of loyalty testing is higher than the threshold, then Alice is considered as dishonest. Following the above example, Bob asks Alice to publish operation (X), which performs on qubit 1; then, Bob performs X on qubit 1 to recover the state into |0〉.
Lo’s no-go theorem15 provides a cheating strategy for learning all messages in a one-sided two-party secure computation, which doubts that one-out-of-two QOT is insecure. The key to Lo’s cheating strategy15 is requirement (A-i), namely, that “Bob learns f(i(m0, m1), j) unambiguously” (the i(m0, m1) represents a pair of messages in a one-out-of-two QOT scenario), which leads to a probability of 100% that the selected state will collapse. In addition, the result is obtained after reversible operations. As a result, choices can be made repeatedly to learn all messages, as shown in Eq. 3, where \({U}_{{j}_{0}}\), \({U}_{{j}_{1}}\), G and |ϕ〉 represent two different selected operations, any unitary operation for inputting two messages and any quantum state, respectively. Therefore, once Bob learns the content of a message, he can recover the state G × |ϕ〉, which is the state after Alice’s input, by applying the selected operation \({U}_{{j}_{k}}\) and its inverse operation \({U}_{{j}_{k}}^{\ast }\), where k ∈ {|0〉, |1〉}. In this way, Bob can change his choice and learn the contents of all messages by repeating the above process.
Definition B corresponds to the one-out-of-two QOT scenario covered by Lo’s proof15. Obviously, definition B is a special case of definition A. Definition B describes the case in which Alice inputs her messages first and then Bob inputs his choices. The important point here is that if Bob inputs his choices first and Alice subsequently input her messages, as in definition C (the proposed protocol), this scenario is not equivalent to the function considered in Lo’s proof15. This is because the function becomes f(i(m0, m1, j), j) when Bob inputs his choices first, and f(i(m0, m1, j0), j1) is meaningless with respect to f(i(m0, m1, j), j). Therefore, Bob cannot change i from i(m0, m1, j0) to i(m0, m1, j1) without Alice’s help. Following from the above relation, in the proposed protocol (definition C), the result after Bob’s and Alice’s actions can be expressed as
Here, \({U}_{{j}_{0}}=I\), \({U}_{{j}_{1}}=H\), and G ∈ {I, X, Y, Z}. Eq. 4 shows that Bob cannot invert the qubit state without possessing information about G. Therefore, Bob cannot perform Lo’s cheating strategy15. As a result, Bob cannot reverse the effects of his inputs without Alice’s help. The condition of Equation 4 shows that the proposed function f(i(m0, m1, j), j) is similar to that of He’s proof19,30. This proof shows that the order of input of the choices and messages may change the function f, which means that this protocol is not subject to Lo’s no-go theorem. In addition, He30 has extended the concept of his proof19 to the general case; if Alice and Bob interact with each other and Bob cannot eliminate the effects of his operations independently, then the interaction is covered by He’s proof19 and resists Lo’s cheating strategy15.

Definition A: ideal one-sided two-party secure computation

(A-i) Bob learns f(i, j) unambiguously.
(A-ii) Alice learns nothing about j and f(i, j).
(A-iii) Bob learns nothing about i more than what logically follows from the values of j and f(i, j).

Definition B: one-out-of-two OT (Lo’s no-go theorem
15
)

(B-i) Alice inputs i, which is a pair of messages (m0, m1).
(B-ii) Bob inputs j = 0 or 1.
(B-iii) At the end of the protocol, Bob learns the content of message mj but not of the other message \({m}_{\bar{j}}\); i.e., the protocol is an ideal one-sided two-party secure computation, with f(m0, m1, j = 0) = m0 and f(m0, m1, j = 1) = m1.
(B-iv) Alice does not know which mj Bob received.

Definition C: the proposed protocol

(C-i) Bob inputs j = 0 or 1 to change the qubit state to {|0〉, |+〉} (Z- or X-basis) in accordance with his choice intention.
(C-ii) Alice inputs her messages m0 and m1 using {I, X, Y, Z}.
(C-iii) Bob learns the content of either m0 or m1 using the basis (Z- or X-basis) he prepared.
In conclusion, there three important contributions of the proposed method. First, to the best of our knowledge, the proposed protocol is the first one-out-of-two QOT protocol to be designed directly based on quantum properties without relying on all-or-nothing QOT, and it has been proven to be secure and not subject to Lo’s no-go theorem15. A simple and efficient one-out-of-two QOT protocol with single nonorthogonal qubits, in which one of the two messages is discarded automatically, has been successfully developed based on the most basic properties of quantum machines. Second, the proposed protocol can effectively prevent both external and internal attacks, as proven by a detailed security analysis. Regarding internal attacks, an important feature of the proposed protocol is that loyalty testing is applied to provide security against internal attacks by a dishonest Alice or Bob; the dishonest one can always be detected at the loyalty testing stages with safety parameters ξ2, ξ3 and ξ4, respectively. Finally, the proposed protocol has a lower cost and is more efficient than many traditional protocols based on a two-level structure. In addition, as this protocol uses only a single qubit, it is easily implemented.
