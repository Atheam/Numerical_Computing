Sniffing speeds up chemical detection by controlling air-flows near sensors
#https://www.nature.com/articles/s41467-021-21405-y
Most mammals sniff to detect odors, but little is known how the periodic inhale and exhale that make up a sniff helps to improve odor detection. In this combined experimental and theoretical study, we use fluid mechanics and machine olfaction to rationalize the benefits of sniffing at different rates. We design and build a bellows and sensor system to detect the change in current as a function of odor concentration. A fast sniff enables quick odor recognition, but too fast a sniff makes the amplitude of the signal comparable to noise. A slow sniff increases signal amplitude but delays its transmission. This trade-off may inspire the design of future devices that can actively modulate their sniffing frequency according to different odors.
Dogs are well known for their excellent sense of smell, and working dogs are still the primary way of detecting odors in uncertain environments such as drug detection in airports and cancer detection in hospitals. However, using dogs as chemical detectors is expensive and at times unreliable1. Consequently, much work has been done on designing and building electronic noses2. Improving electronic noses involves improving either the sensor or the system that delivers odors to the sensor. Commonly, a sensor is heated in order to broaden the response of the system3,4. Odor delivery is a challenging problem and several investigators have designed biologically-inspired devices to deliver the odors. Staymates et al. used a 3D printed dog’s nose to inhale and exhale odors, which improved the detection due to drawing in airflows directly from the source5. Kohnotoh et al. used dual air pumps to imitate an inhale from the nostrils, determining directionality from the difference in response6. In this study, we build a sniffing device to visualize and measure the benefits of sniffing at different frequencies.
Using a device to study sniffing can give insight into biology. Although most mammals sniff, a clear benefit for this behavior is still missing. Potential hypotheses include creating turbulence to better mix the odor and providing repeated trials for identifying and confirming odors7. By far, the majority of olfaction studies have been on animals such as rodents and dogs. Studies of dogs of different sizes suggest that sniffing frequency ranges from 4–8 Hz and does not change systematically with body size5,8,9,10. However, other animals such as mice11,12,13,14 sniff at up to 12 Hz. On the other size extreme, elephants are extremely adept with their olfactory system and are being used to detect substances at low concentration such as TNT15, yet their sniff frequency had never been measured. In this study, we present a scaling law for sniffing that incorporates a larger range of body mass. We also present a series of mathematical models based on the pressure, compliance, and turbulence within the respiratory system to rationalize the scaling of sniff frequency with body size.
The data from our mechanical sniffer is rationalized through a fluid mechanics model of odor detection. Our model builds upon previous theoretical solutions for oscillatory flow in an artery, derived by British mathematician John R. Womersley at the advent of cardiovascular fluid mechanics studies in the 1950’s16. Previous models of sniffing flows have generally been computational17 rather than analytical18, and have relied on the complex nasal cavity system in the animal. However, few models can incorporate the complexity of biological nasal passages, the chemical-sensor response, and the fluid mechanics of the air flow, each difficult problems in their own right. Building biologically-inspired devices like ours can be an important first step in testing biological hypotheses, verifying theoretical studies, and detecting odors quickly and reliably.
In this work, we show sniffing airflows can improve the speed and amplitude of the signals measured. We pay particular attention to a dimensionless group called the Womersley number that takes into account the width of the channel and the frequency of sniffing. High-frequency sniffing is useful for both sensors and animals because it obtains data faster than a single inhale of air. Our bellows-driven system GROMIT, along with our theoretical model, demonstrates that choosing a frequency of sniffing should consider trade-offs. The faster the sniff, the lower the signal per sniff but the more data per unit time. Choosing sniff frequency should thus depend on whether the user is trying to maximize data or obtain data as quickly as possible.
We measure the sniffing dynamics of mammals, from mice to elephants, with details given in the experimental methods section. We use a specially prepared food box and microphone setup to solicit sniffs from an African elephant at Zoo Atlanta, measuring three sniffs from 21 attempts. We combine these rates with data from previous literature, including one study on dogs9, three studies on rodents9,13,19, one study on rabbits20, and one study on shrews21. YouTube videos provided two more data points, including a horse and giraffe, whose masses are assumed to be those of adult animals. Figure 1 shows examples of the audio waveforms of sniffing for a rat, dog, elephant, and giraffe respectively. The animals sniffing frequency decreases with increasing body size, from 8 Hz for a rat, 5 Hz for a dog, to 2 Hz for the giraffe and elephant.
Animal silhouettes are from freepik.com.
 Figure 2a shows the relation between sniffing frequency and body mass. The solid black line indicates the power law best fit for the experimental data,
where maximum observed frequency f is in Hz and body mass M is in kg (N = 16, R2 = 0.85). In the math methods section, we compare this experimental trend to predictions from four theoretical models, designated fi, and marked by the blue lines in the figure.
a The relationship between maximum observed sniff frequency f (Hz) and body mass M (kg). In addition to elephant sniffing trials conducted here, black data points are from dogs, rodents, rabbits, and shrews from previous studies as well as a rat, dog, horse, and giraffe from YouTube. The black solid line is the power law best fit to the experiments. For comparison we include four theoretical predictions fi using blue lines and the respiratory rate shown by the red dot-dot-dash line. Animal silhouettes are from freepik.com. b Profile of a dog’s nose, with the white cavities denoting the nose, nasal cavity, trachea, and lungs, moving from left to right. Here, Vtot (in short dash blue) is the total volume of air which must be accelerated each sniff, \({V}_{{\rm{sn}}}\) (in long dash green) is the sniffing tidal volume of new air brought into the respiratory system, rt is the trachea hydraulic radius, and L is the change in position of the sniffing front.
In models f1 and f2 we consider inertial effects. We predict f1 through consideration of geometry of the nasal passages. In f2 we use Leith’s 1960’s experimental measurements22 of the compliance and inertance of a range of animal respiratory systems to determine their resonant frequency. Although f1 and f2 use independent data sets, they result in predictions that both compare favorably with the experimental trend, indicating the importance of considering inertial effects.
We consider the effects of viscosity in models f3 and f4. In model f3, we provide a limiting sniffing frequency related to the maximum Reynolds number23 associated with laminar flows. Animals below 30 kg fall below the trend line f3, indicating animals of this size or lower experience laminar flows during sniffing. Model f4 is derived from relations between flow rate and Womersely number. The poor fit of model f4 may be due to the use of an infinite tube to characterize the finite-length trachea.
For further comparison, we also include a red line indicating the frequency of relaxed breathing fr = 0.89M−0.26 (N = 692) reported by Stahl in 196724. Comparing the black line to the red line indicates that sniffing occurs 10 times faster than breathing. The exponents for the sniffing, breathing, and the theory (models f1 and f2) have comparable values (from −0.18 to −0.26), suggesting that the dominant physics we have proposed is correct and has predictive power. To understand why animals sniff faster than they breathe, we turn to flow visualization of sniffing.
We design and build a bellows system that we call GROMIT, or Gaseous Recognition Oscillatory Machine Integrating Technology, which imitates a sniff by sampling ethanol vapor at set frequencies. More detail on GROMIT is given in the experimental methods. In Fig. 3, we show a schematic where GROMIT is combined with humid air and a laser light sheet to visualize the airflows resulting from sniffing. Figure 4 shows a schematic representing the different aspects of the system with its integrated sensors.
Flow is driven in an oscillatory motion by a custom diaphragm pump (III), illuminated by laser light sheet (IV), and filmed by a high speed camera (V).
Scale bar represents 1 cm.
The airflow of a sniff is characterized by the hydraulic radius of the ethmoidal chamber Dh/2, the frequency of oscillation f, and the kinematic viscosity of the air ν. Together, the dimensionless group that characterizes the system is called the Womersley number, Wo, which was first used to describe cardiovascular flows25,26 and may be written
We define Wormesley number in terms of half the hydraulic diameter to stay consistent with the theory derived by Womersley16. Higher Womersley numbers are associated with higher relative magnitudes of inertia compared to viscous forces. We identified four animals for which the Womersley number has been measured throughout the nasal cavity: these include a pygmy marmoset27, rabbit20, dog8, and deer28, which have Womersley numbers of 0.2–2.5. The pygmy marmoset has a mass of 0.1 kg whereas the deer weighs nearly three orders of magnitude more at 60 kg, indicating that Womersley number changes slowly with body mass. We perform our device testing within the range of Wo from 0.5 to 7.5 to try to encompass the observed biological range. Reporting Womersley for animals requires CT-scanning to map the complex nasal cavity. These maps are reduced to a simplified shape using the hydraulic diameter, which takes into account both the cross sectional area and the perimeter of the chamber29. Craven et al.8 define hydraulic diameter as
where Ac is the cumulative surface area of the olfactory surface calculated with finite difference numerical integration and P is the perimeter of the cross section of interest. Thus, a complicated olfactory structure can be reduced to a cylindrical shape for ease of calculation of the associated flows.
In GROMIT, flows are generally unidirectional with respect to the tube axis, with a velocity that varies with time and distance from the tube wall. We illustrate these properties with the flow field at the transition from inhalation to exhalation, where the applied pressure transitions from positive to negative. Figure 5e, f show the observed velocity field for Womersley numbers of 1.5 and 7.5. As indicated by the arrows, the flow at the walls changes direction before the midstream flow does. A model for molecular deposition on a sensor should thus take the time and space varying flows into account. These flows are comparable to those generated with COMSOL Multiphysics to solve for the flow due to an oscillatory pressure, as shown in Fig. 5c, d.
a–b Illustrations showing a particle in low Womersley flow (a) has a better chance to strike the sensor surface than in high Womersley flow (b). Uz is the axial velocity, x is the diffusion distance, and ds is the sensor diameter. c–d Simulated flow profile at transition from inhalation to exhalation for Wo = 1.5 and Wo = 7.5, respectively. e–f Particle image velocimetry of flow profile at transition from inhalation to exhalation for low and high Wo respectively.
We present a mathematical model in the Supplementary Information that predicts the flow velocity in a circular channel, which we use to approximate our experiments in a square channel. A key feature of our model is tracking the diffusion time of molecules given by the ratio of the sensor width ds = 5 mm and the particle’s speed, which is directed parallel to the face of the sensor. The slower the air speed, the more time the molecules spend in the vicinity of the sensor, and in turn, the closer to the sensor they may travel by diffusion. In our model, Womersley theory gives a closed form solution for the velocity field as a function of distance from the sensor. We discretize the sniffing cycle into discrete time points. At each time point, we calculate a diffusion time and the maximum distance from the sensor that particles can still diffuse onto the sensor. We then integrate across all points in the cycle to determine the net diffusion of molecules onto the sensor.
In short, our model is a quasi-steady diffusive model where odor is advected according to Womersley flow, but then accrues on the sensor by diffusion. There is no time-dependence on the concentration field. Because the diffusion time scale is much longer than the convective time scale, only a thin layer of the air volume has a chance to diffuse onto the sensor. For our channel of 1 cm radius, the layer of detected air is only 0.35 mm thick.
To characterize the sensor response to different Womersley numbers, we conduct tests with ethanol. Figure 6a shows the time course of sensor current (mA) for an ethanol concentration of 89 parts per thousand. Ethanol reacts with the sensing layer by causing oxide ions to release electrons, thereby reducing the sensor’s resistance and increasing the flow of current.
a Time course t of the current I across sensor due to introduction of 89 parts per thousand concentration of ethanol at t = 30 sec. In the shaded regions, the ethanol sample bottle is absent from the space; in the remaining regions, the ethanol is present. b Relationship between estimated concentration C of ethanol in headspace and current amplitude A. Black diamonds, red triangles, green circles, and blue squares indicate response for frequencies of 0.14, 0.2, 0.25, and 0.3 Hz with associated Womersley numbers of 1.25, 1.5, 1.65, and 1.8 respectively. Error bars represent one standard deviation (s.d.). c Relationship between amplitude A and product of Womersley number Wo and concentration C. Data collected at concentrations of 8.9 parts per thousand, 44 parts per thousand, and 89 parts per thousand represented by the purple circles, cyan triangles, and orange squares respectively. Mathematical models for concentrations of 8.9 parts per thousand, 44 parts per thousand, and 89 parts per thousand represented by the purple, cyan, and orange solid lines respectively. Shaded region shows where no additional information can be obtained by sniffing. At a WoC of less than 0.01, the response returns to baseline each sniff. Below 0.03 mA, no measurable response can be obtained due to the signal dropping underneath the noise threshold of the sensor. Open purple circle represents the optimal collection rates for the 8.9 parts per thousand concentration tests with the chosen sensors. Error bars represent one standard deviation (s.d.). d The relationship between number of available molecules for collection Nd and Womersley number. Dashed red line indicates number of molecules available per cycle. Solid green line indicates the number of molecules available per second. Open red and green circles represents collection rates for 8.9 parts per thousand concentration.
The trial begins with GROMIT sniffing using motion of its bellows. The sniffing motions are performed for 30 sec without exposure to ethanol. In this time frame, clearly there is no change in current because the air is empty of ethanol. When ethanol is introduced, the sniffing continues, and the current increases from 10 to 20 mA. Current oscillations of amplitude A are synchronized with the motion of the bellows. At a time of 90 sec, ethanol is removed and the current gradually decreases to a baseline value as the ethanol is evacuated from the sensor. Of these features, the initial increase in current due to odor exposure is a standard feature used by many30,31,32,33 to identify an odor. However, without sniffing, this feature requires a time scale on the order of a minute to obtain useful information, which is too long to be useful for animals on the move. In comparison, sniffing brings information to the animal on a 2π/f time scale, which for our sensor is 7 sec. The increased speed of information transfer may be one reason that high-speed sniffing evolved in animals.
We perform 48 experiments, consisting of 16 tests for each of three different ethanol concentrations (8.9, 44, and 89 parts per thousand). Figure 6b shows the relationship between the amplitude of the sensor current and the concentration of ethanol. The closed symbols (black diamonds, red triangles, green circles, and blue squares) represent the current amplitude for different sniffing frequencies (0.14, 0.2, 0.25, and 0.3 Hz, respectively). The resulting amplitude increases with increasing concentration of ethanol and decreasing frequency, in accordance with the theory presented in the Supplementary Information mathematical modeling section.
We briefly discuss a caveat with regards to the generality of our theoretical model. Our theory assumes the target odor is diffusive in the chosen flow medium such as air. Diffusion enables the odor to leave the streamline and land on the sensor. The ability for an odor to diffuse is characterized by the dimensionless Schmidt number Sc given by the equation
where ν is the kinematic viscosity of the fluid and D is the mass diffusivity coefficient. We used ethanol because it is a commonly used chemical and is easily available for testing oxide sensors. For ethanol vapor in air, with a mass diffusivity D = 11 × 10−6 m2 s−1 and kinematic viscosity ν = 1.48 × 10−5 m2 s−1, the Schmidt number is 1.4 and within the diffusive regime34. Future workers who wish to apply our model will need to use target chemicals for which34 Sc < 4. According to the Schmidt number, large particles such as dust do not diffuse sufficiently and would require a different technique to capture than the one featured here.
Diffusion can also lead to other effects such as Taylor-Aris dispersion which tends to stretch the distribution of molecules as it travels down the axis of the tube35. According to this physical picture, the current amplitude would decrease and the period would increase over multiple sniffs. However, over a series of ten sniffs, we find that the period and the amplitude remain constant. Thus, we conclude that at the speeds and geometries of our system, Taylor-Aris dispersion is negligible. Future apparatuses using different speeds or chemicals may encounter this effect and are advised to turn to the work of Smith36 and Ng37 for interpreting their results.
We now apply our theory to predict the current amplitude for all 48 experiments. We do so by considering the new variable, WoC, the product of Womersley number and ethanol concentration. Figure 6c shows the relationship between sensor current and WoC across three different ethanol concentrations. The solid lines are theoretical predictions given by equation 16 in the Supplement. This prediction relies on a single fitting factor β which relates the sensor current to the number of ethanol molecules in the air received. The resulting graph is inherently dimensional due to the sensor response’s dependence on input concentration. The theory fits the experiments quite well. The basic trend that can be seen is that signal amplitude A decreases with increasing Womersley number. We may use this trend to understand how both animals and devices might optimize sniffing to maximize the amount of information or the rate of the information transfer.
Increasing the frequency of sniffing decreases the duration of the first sniff, enabling data to be obtained more quickly. However, there is a tradeoff. The higher the frequency, the higher the Womersley number, the lower the amplitude of the response (Fig. 6c). If the frequency is increased further, ultimately the amplitude of the response will become so low that it is indistinguishable from noise. For the metal oxide sensor in our study, this noise limit is ~0.03 mA as indicated by the horizontal gray region at the bottom of Fig. 6c.
Too slow a sniff has other downsides as well. A slow sniff can be considered as a continuous flow trial, whose effectiveness has been studied in the past38. Because the signal returns to a baseline value in each sniff cycle, no new information is obtained beyond a simple inhale. For example, if the sniff in Fig. 6a was too slow, the current would simply increase from 10 to 20 mA for each sniff, and the amplitude A would equal the traditionally measured total magnitude change, here, 10 mA. The slow sniff limit occurs at a value of 0.01 parts per thousand for the product of Wo (Womersley number) and C (concentration) as indicated by the left-hand shaded region of Fig. 6c.
A similar optimization problem arises when considering the information per sniff (time scale T = 1/f) and the information per unit time (time scale T = 1 sec). We address this problem using our theoretical model. The relationship between the available molecules Nd and the Womersley number is shown in Fig. 6d. The dashed red curve is the number of molecules per sniff which exponentially decreases and the solid green curve is the number of molecules per second which is roughly linear. If an animal wants to maximize information per unit time, it should sniff at higher Wo. This indeed might be what animals do: when exposed to new odors,13 mice and rats increase their sniffing frequency by up to 75%. This behavior increases Womersley numbers from 2 to 2.8 and according to our theory, and increases the information per unit time by 10%.
For the specific sensors chosen in this study, and an 8.9 parts per thousand ethanol environment, the highest frequency that can be sniffed is 0.3 Hz, which corresponds to the open purple circle data point in Fig. 6c at Wo = 1.8. At this rate, the device is sniffing as fast as possible to maximize the total number of molecules per second but still generates a signal above noise based on parameters for our experiments. The expected number of available molecules for collection is 1.6 × 1014 molecules per sniff as shown by the open red circle in Fig. 6d and 0.34 × 1014 molecules per second as shown by the open green circle in Fig. 6d. These circles indicated the desired regime for sniffing with the chosen sensor. Future designers of electronic nose systems could use sniffing in the appropriate regime to improve their devices for applications such as detecting fruit ripeness39 and other odor-based tasks40. Such designs should adhere to the same trade-off for sniffing: sniff fast enough to get the most information per unit time, but not so fast that the signal per cycle disappears into noise.
Our derivation of an optimal sniffing frequency is valid for a single target chemical. In nature, there are often several target chemicals, each with their own optimal frequency. This is another reason why animals may need to modulate their sniffing frequency in response to unknown odors.
In our study, we used sensor measurements to show that sniffing can improve the acquisition of olfactory data. We hope our work inspires improvements in sensor design, and gives insight into biological sniffing. The results from our study on a simplified model system however should be applied with care to the more complex systems of animals. Animals’ noses consist of a complex system of turbinates, whereas in comparison, our system simply consists of a single tube. Our system thus neglects the complex geometry, the benefits of which are yet to be understood.
Our tests only use ethanol, a single source of chemicals, whereas in nature, odors will be combinations of different chemicals. Additionally, our device does not have a liquid coating analogous to the mucus of the biological nose which would require even further time for odorant molecules to diffuse through. In natural noses, different odors land on different portions of the olfactory epithelium, an effect termed odorant partitioning or differential sorption41. Our study assumes a uniform of collection of odors along the channel. This assumption is most relevant for relatively insoluble odors, which are deposited rather uniformly along mucus-lined olfactory airways10.
Our theory showed that increasing sniffing frequency brings more molecules to the sensors’ vicinity per unit time. In fact, mice and rats increase their sniffing frequency when exposed to new odors12,13. Thus, neurological decoding mechanisms may rely on bringing more total molecules per unit time rather than per unit sniff. For insects, odor stimuli can be resolved on the order of 100 Hz42. If the neurological response of the mammalian system is as fast, then sensor sensitivity may not be the bottleneck for maximizing sniff rate.
There may be other constraints on sniffing which we discuss here. For a sniff to be recognized, the sniff must be sufficiently long that odorants can travel to the rear of the nasal cavity where they will be sensed. This constraint may place a constraint on sniffing frequency. For example, dogs have an average velocity through the nasal cavity on the order of U = 5 ms−19,10, and a snout length on the order of L ≈ 0.1 m43. For the sniff to reach the sensory region, the inhalation duration must be at least L/U = 0.02 sec, and the period must be 2L/U = 0.04 sec. This ensures the frequency must be less than 25 Hz which is 3–5 times faster than observed frequency of dogs, 4–8 Hz. We thus conclude that sniffing airflows have plenty of time to reach the position that they are sensed.
Maximum sniffing frequency in animals may also be limited by the ability of odors to diffuse through the mucus layer. Mucus in the nose protects the sensors and serves as a self-cleaning barrier to outside particles, viruses and bacteria. The mucus of a dog’s nose is ~10 μm thick44,45,46,47 and has negligible influence on the fluid motion of the air10. However, the diffusion coefficient of molecules through mucus ranges from 6.5 × 10−10 to 8.2 × 10−10 m2 s−1, whereas diffusion in the air is of the order 10−6 m2 s−1. Given a diffusion distance equal to the dog’s mucus thickness, x = 10 μm, Supplemental equation 4 can be solved for the travel time ts = 0.06 − 0.08 sec, which is associated with frequencies of 12–17 Hz. This mucus diffusion frequency is faster than the sniffing frequency of dogs which ranges from 4–8 Hz. Thus, the bottleneck for information gathering during the sniff is not in the mucus but rather in the flow of information through the air. This idea is consistent with experiments by Uchida and Mainen48, which show that rats can recognize odors as quickly as the first sniff.
Energetic constraints may give another limit to sniffing frequency. Crawford et al. found the dog’s respiratory system has a natural resonant frequency of approximately the same frequency as panting and sniffing at 5 Hz49. Seven years later, Spells50 proposed a respiratory system scaling which can be taken as a (damped) spring-mass oscillator to scale as f ~ M−0.19. If the sniff frequency deviates too high above this natural frequency then it could be too energetically costly to maintain9. The energetic exertion may be one reason why quicker bouts of sniffing are only observed for a limited time12,13. We did not include these energetic constraints in our model since the electronic nose mimic is made with a diaphragm of plastic and latex exhibiting a different resonant frequency to that of a natural respiratory system.
Additionally, at higher frequencies above Wo = 1, the same applied pulsatile pressure difference induces a reduced flow rate (and thus volume of air inspired)18. However, in the experiments with GROMIT, we maintain the amplitude of the physical plunger through direct control of the stepper motor. This thereby ensures that the same volume of air is inspired and expired each cycle, independent of sniff frequency. Therefore, in the mathematical model, we ignore the losses in the volume flow rate. However, since the stepper motor must pull harder as Wo increases, the power required to do so may ultimately limit the highest frequencies of future devices.
We utilized low-cost chemical sensors for this study. While beneficial for wide adoption of our techniques, the sensitivity of the sensors required relatively high ethanol concentrations. Additionally, our measurement of current amplitude could be influenced by a number of factors, such as humidity51,52, pressure53, temperature3,4, and mean flow rate54,55. Therefore, the order of measurements were reversed on alternating days to ensure the trends were independent of humidity, pressure, and temperature. Lastly, in our mathematical derivation, we assume a circular cross section for the channel. In our experiments, however, the channel is a square cross section because the sensors are flat. Also, our theory assumes fully developed flow, yet our experiments use a channel that is 4 diameters long, which is less than the requirement of 10 diameters to ensure a fully developed profile56. Future workers may weigh the costs and benefits of increasing their channel length.
One way to increase the signal to noise ratio of the sensors would be to simply average the response over multiple sniffs57. If the noise is additive, random, and zero-mean, then averaging over multiple sniffs should allow for positive noise to cancel with negative noise. This could theoretically lower the lower cut-off indicated by the lower shaded region of Fig. 6c. To apply such a solution, the noise needs to be random and centered in the signal mean. We only measure positive current, so the noise is not the same below the signal than above the signal. Therefore, in this case, averaging the signal will not work, in particular when the signal amplitude is similar (and lower) than the noise level. Additionally, for dynamically changing environments such as are experienced by animals, repeated measurements are often not possible. However, it is possible that animals might use such methods to get above the noise thresholds of their own sensors.
Sound recordings of a 35-year-old female African Elephant (Loxodonia africana) of mass 3360 kg and height 2.6 m were taken at Zoo Atlanta in the fall of 2018. We conducted experiments indoors at the edge of the elephant’s enclosure in the mornings before the zoo opened to the public. All experiments were guided by the staff at Zoo Atlanta without any direct contact by the authors.
A subdivided 30 cm × 60 cm padded box was placed at a location ~1 m outside the enclosure where the elephant could not visually see the box due to obstruction by the bars of the enclosure. For each trial, bran cubes were placed at a different location every time, in position inside or outside the box. The curators instructed the elephant to reach for and find the food. The elephant employed multiple strategies to find the food including sweeping its trunk side to side in the box as well as sniffing for the food. In the trials where the elephant used predominately sniffing to search, the inhalations and exhalations were recorded with a Blue Yeti-series Snowball microphone, similar to methods used with dogs58. The most distinct audio waveform was produced in a trial where the food was placed behind a circular cutout just smaller than the elephant trunk tip diameter. Out of 20 trials, three sound recordings were clear enough for the sniffing bouts to be distinguished from the sound of the trunk knocking into the walls of the box.
The sound recordings of each sniffing bout, including the elephant experiments and non-elephant third party YouTube videos, were manipulated using Audacity’s noise reduction effect to reduce the background noise by ~20 dB. The maximum number of peaks in the amplitude per second corresponding to an audible sniff was used to calculate the sniffing frequency. Videos of a horse, giraffe, rat, and dog were analyzed using this method. The maximum sniffing frequency of the rat and dog were confirmed with points from the literature9,13,13,19.
All experiments were performed in accordance with relevant guidelines and regulations. The Georgia Tech Institutional Animal Care and Use Committee approved protocol number A18068 entitled, “Elephant Sniffing, Breathing, and Suction” for dates November 12, 2018–November 12, 2019.
We designed and fabricated a sniffing device named the Gaseous Recognition Oscillatory Machine Integrating Technology (GROMIT) which mimics the sniffing mechanics of mammals. The device is designed in modular sections for maximum adaptability. The sections include a custom 3D printed PLA plastic diaphragm pump with a rubber membrane, a Sensirion Venturi flow meter, a custom 3D printed PLA plastic sample housing, and four printed circuit boards with 4 Figaro TGS 2610 sensors on each board.
A schematic of the device can be seen in Fig. 4. A sniff begins with commands from an Arduino Uno microcontroller to a motor controller which in turn sends commands to an Anaheim Automation 15Y2025-LW4 stepper motor. The motor’s axial motion is converted from rotational to linear actuation using a custom slider-crank mechanism which is the driving force behind a 3D printed diaphragm pump. The diaphragm pump is shaped in a way to generate the same amount of volumetric flow rate per actuation, thereby mimicking the ability of a mammal’s lungs to expand and contract.
By conservation of mass, the relationship between the desired air velocity and system geometry is
where At is the cross-sectional area of the tubing, δVb is the volume change of the bellows, \({U}_{\max }\) is the desired maximum air velocity, and f is the desired frequency of sniffing between 0.1 and 10 Hz. The bellows volume and tubing area were designed so that the Womersley number of the flow could be modified between 0.5 and 7.5 to represent almost the full range found in mammals.
On the other side of the pump is a Sensirion Venturi flow meter which tracks and verifies the input flow oscillations. The flow meter confirms a one-to-one correspondence between the flow velocity and the input motor signal. The flow sensor is also used to ensure the same average flow rate is obtained for each trial. Next is a series of Figaro metal oxide sensors that were powered on at least 1 week before its first use in order to heat up and remove contaminants, a process called burn in. The sensor section incorporates 4 TGS sensors per board in series for a total of 16 sensors. The board draws ~700–800 mA and is kept powered on before and after each measurement test to elude transient unstable response that appears when power is applied to the sensor when it was unpowered for some time59,60. In our experiments, we run the sensors at a voltage of 5.6 V. Last is a section for the test sample to be placed where the headspace is in series with the flow. In order to avoid unwanted dead spaces in the flow path, the tubing cross sectional area was designed to be constant across all sections. The dead volume in the tubing is estimated to be on the order of 60 mL.
We mixed our odor source before conducting trials. We performed experiments with three concentrations: 1 part ethanol to 10 parts DI water by volume, equal parts ethanol and DI water, and pure ethanol solutions. To determine the concentration, Henry’s law \(C=\frac{{\rho }_{{\rm{e}}}}{uH{P}_{{\rm{atm}}}}\) was utilized with ethanol density ρe = 789 kg m−3, ethanol atomic mass u = 0.04607 kg mol−1, Henry’s constant H = 1.9 mol m−3 Pa−1, and pressure Patm = 1 atm = 1,01,325 Pa34. Using this conversion, the concentration levels tested were 8.9 to 89 parts per thousand. These reported concentrations are estimated at the inlet and provide upper limits for the expected lower concentrations which make it to the sensors themselves.
Tracer particles were generated in the form of humid air generated by a Crane humidifier model number EE-5301. The humid air was introduced into the entrance of the flow using a tee junction to ensure no net momentum was added to the oscillating flow pattern of the sniffing device, Fig. 3. A rectangular channel was built with approximately the same cross sectional dimensions as the rest of the tubing in order to maintain unidirectional flow. A section of the channel was removed and replaced with an optically clear acrylic section with toothpaste applied to the inside to prevent fogging. A Viper laser model number 37-0108 by GLD Products was positioned to shine through the top of the channel, illuminating the particles in the middle of the flow. A Phantom Miro model 320s high speed camera with a Canon 65 mm lens recorded the flow for nine total experiments, at three frequencies of 0.3, 1.3, 2.3 Hz, and at three positions (top, middle, and bottom of the channel). Once recording was finished, analysis was done using the Matlab tool PIVLab. We wrote a Matlab script to separate each video into individual frames and convert each frame to greyscale to speed up the PIVLab process. A region of interest was established and each frame was processed in PIVLab before analysis. Stills from video showing the bottom of the channel when sniffing at 0.3 and 2.3 Hz can be seen in Fig. 5 e, f respectively.
The flow simulations are conducted using COMSOL Multiphysics in two dimensions. The chamber is represented as a rectangle with dimensions 30 cm × 2 cm. The entrance and exit regions are 1 cm × 2 cm rectangles to represent the tubing connected to the test chamber. The inlet condition is set as an oscillating normal inflow velocity with magnitude varying sinusoidally according to the input frequency of the trial. The outlet condition is zero atmospheric pressure. The walls of the chamber are set as no slip boundary conditions. Initially, the air in the chamber is at rest. The system utilizes the default normal sized physics-controlled mesh.
Here, we present four models for the relationship between sniffing frequency and body size. We begin with a model that consider’s the air’s inertia. Sniff volumes, also known as a sniffing tidal volume, from literature9,13,61 follow the trend \({V}_{{\rm{sn}}}=2.15{M}^{0.99}\) mL (N = 7) where M is body mass in kg. Using this scaling, a 20-kg dog inhales 42 mL of air during each sniff cycle, the same volume as a shot glass. For comparison, a mouse inhales 0.045 mL of air each sniff, the same volume as an eye-dropper drop, and an elephant inhales 4.6 L, the same volume as 1.2 gallon jugs. The control volume \({V}_{{\rm{sn}}}\) in Fig. 2b denotes the sniffing tidal volume before it is inhaled into the lungs. The lung volume is generally 25 times larger than the sniff volume, as shown by Stahl’s measurements of lung volume, Vlung = 53.5M1.06 mL (N = 333)24. When an animal inhales, it uses its diaphragm to apply a pressure P to an airway with a cross sectional area \(\pi {r}_{{\rm{t}}}^{2}\) where rt is trachea hydraulic radius, which has been found in experiments by Tenney62 to scale as rt = 0.0023M0.4 (with rt in m and M in kg). The force applied to the air may be written
where we neglect any losses due to viscosity. The maximum pressure \({P}_{\max }\) of the lungs, generated by muscular contraction, is independent of body size, and has constant peak magnitude of 10 kPa63. Throughout the duration of the sniff, the pressure is assumed to vary from positive to negative 10 kPa in a sinusoidal fashion. Therefore, the positive and negative mean values of the pressure waveform are \(P=\pm\! \frac{2{P}_{\max }}{\pi }\)64. This pressure is sufficiently low that we can consider air to be incompressible.
With air being incompressible, we consider a volume Vtot of air that must shift in order to accommodate a new sniffing volume \({V}_{{\rm{sn}}}\) to enter the respiratory system, denoted by the short dashed blue and long dashed green lines in Fig. 2b respectively. The mass m of the volume may be written as the product of the air density ρ and the total volume, Vtot. The total volume of air in the respiratory system Vtot may be written as the sum of the vital capacity Vc = 56.7M1.03 mL (N = 315)24 and the functional residual capacity Vr = 24.1M1.13 mL (N = 261)24: Vtot = Vc + Vr. We approximate this sum using a power law best fit of these two trends, which yields, Vtot = 83M1.06 mL.
During a sniff, each air molecule is shifted by a distance \(L={V}_{{\rm{sn}}}/(\pi {r}_{{\rm{t}}}^{2})\) during each period 1/f. Assuming a sinusodial motion of the air with displacement \(s(t)=L\sin (2\pi ft)\) yields an acceleration a = s″ of magnitude \(4\pi {V}_{{\rm{sn}}}{f}^{2}/({r}_{{\rm{t}}}^{2})\). By Newton’s second law, the inertial force on the air may be written Fa = ma where a is as above and m = ρVtot. Together,
The inertial force on the air Fa equals the applied force of the lungs FL, given in Equation (6). Solving for the frequency f yields our theoretical prediction for sniffing frequency which we call f1:
We proceed by substituting scaling power laws for rt, \({V}_{{\rm{sn}}}\), and Vtot = Vc + Vr into the above equation, which yields the sniffing frequency,
Our prediction f1 is almost twice as high as the experimental data which shows mammals sniff at a frequency slower than their physical limits, possibly because it is too taxing on muscles to consistently operate at their maximum rate65.
We also give a few caveats with regards to the assumption of sinusoidal pressure. Measurements indicate that larger animals maintain isometric scaling of sniffing volumes. However, according to previous work, as Womersley number increases, the volume flow rate decreases due to viscous effects18. Thus, larger animals may be applying larger pressures to compensate. This correction would bring our prediction closer to the experimental trend.
Previous studies of breathing have shown that breathing is not in fact sinusoidal. For instance, at its natural breathing rate of 2 Hz, a mouse will inhale and exhale within the first 200 ms and then remain still until the next breath. On the other hand, a mouse exploring its environment with a sniffing frequency of 10 Hz will be moving the air for almost the full duration of the sniff66. Since the goal is to create a simple first-order model, we do not attempt to capture these behavioral effects, and continue with assuming a sinusoidal pressure profile. In fact non-sinusoidal sniffing patterns are more difficult to study mathematically, but they give important rationale for the use of our GROMIT device. Since the motor is controlled by a computer, future workers may input different pressure profiles to find their benefits to sniffing.
We next present a model of the natural frequency of the respiratory system first proposed by David Leith22 in 1983. Starting in the 1960s, breathing and panting were modeled by considering the chest cavity as a damped spring-mass oscillator. This model is based on experimental measurements of lung compliance C, resistance R, and inertance I on humans and anesthetized animals. For regular respiration, the time scale of respiration relies on the respiratory system’s resistance and compliance. On the other hand, for high speed sniffing, resistance is negligible compared to inertance. The resulting system has qualities similar to oscillating systems such as the forearm muscle67, and electrical circuits50. Here, the predicted sniffing frequency f2 can be expressed as
where compliance C may be written C = 1.59 × 10−5M1.04 L Pa−1 where M is in kg, based on N = 114 mammals24. Inertance of the respiratory system is dominated by the inertance of the air in the trachea, as in our previous model. Based on the idea that inertial pressures should be invariant with body size, Leith22,68 proposed inertance I ~ M−1/2. Using this exponent, the prefactor can be estimated from Spells50, who gathered N = 15 humans, dogs, and cats from previous workers across a decade of body mass. Using Fig. 7 of Spells’ work, we extrapolate the data points to find I = 7.84M−1/2 Pa L−1 s−2. Combining these power laws, Leith’s prediction yields
which corresponds to the blue dashed line in Fig. 2a. It is noteworthy that Leith’s theoretical model has the same exponent as our first model Eq. (9) and a very similar prefactor (14 vs 17). Furthermore, each model relies on independent measurements: the first model f1 relies on geometrical meaurements, and Leith’s model f2 relies on pressure measurements. Their agreement suggests a consistent physical picture. Overall, these models suggests that sniffing frequency aligns with the respiratory system’s natural frequency. Previously, panting was also proposed to correspond to natural frequency49.
In our next model, we give an upper bound for the sniffing frequency and address the role of viscosity, which has not been considered in the previous two models. Dissipation by viscosity is expected to be important for two distinct flow regimes in the airways69. In the regime of slow air flows, slower than the regular breathing rate, inertial effects are reduced and viscous dissipation dominates. The regime of fast air flows is also potentially dissipative due to the generation of turbulent flow structures and their subsequent energy cascade down to dissipative lengthscales. In order to estimate the occurrence of turbulent flow structures in sniffing, we must take into account both the Womersley number Wo and the Reynolds number Re of the flow in the airways23,70. For the regime Wo ≫ 1, pulsatile flows have their viscous effects confined to a Stokes boundary layer much thinner than the airways diameter70. However, the Womersley number of sniffing animals is at most of the order of the unity18 and thus we instead apply a standard criterion of critical Reynolds number to determine the threshold to turbulence. The maximum Reynolds number associated with laminar flow in the airways is:
where \({U}_{\max }\) is the maximal velocity of the displaced volume of air, the trachea radius62 rt = 0.0023M0.4, with M in kg and rt in m, and ν = 1.48 × 10−5 m2 s−1 is the kinematic viscosity of air. Evaluating the maximal velocity as that of the moving plug of air, \({U}_{\max } \sim 2\pi f{V}_{{\rm{sn}}}/(\pi {r}_{{\rm{t}}}^{2})\) where \({V}_{{\rm{sn}}}=2.15{M}^{0.99}\) mL is the sniffing volume, leads to a relationship between the sniffing frequency and maximal Reynolds number
As shown by the experiments of Winter and Nerem in 1984, turbulence23 in the airways will be unlikely if \({{\rm{Re}}}_{\max }\, <\, 2000\), which can be therefore written in terms of maximal sniffing frequency: \({f}_{3}\, <\, {f}_{\max }\) so that
with M in kg and f3 in Hz. As shown in Fig. 2, the blue long dotted line is above all observed animal sniffing frequencies except for animals of mass larger than 30 kg, such as the horse, giraffe, and elephant. This model strengthens our confidence in neglecting viscous dissipation in our originally proposed model for smaller mammals, and simply balancing air inertia and lung force.
Lastly, we present a model based on work by Loudon and Tordesillas18, who sought to characterize unsteady flow situations similar to those experienced during a sniff. In their model, the amplitude of an oscillating volume flow rate, Q, is related to the maximum pressure P, the radius of the channel rt, the kinematic viscosity μ, and the Womersley number Wo by the equation
Using a flow rate approximated as the sniff frequency times the total volume of air in the respiratory system Q = fVtot and Womersley number according to equation (2), equation (15) can be solved for frequency f4 to be
Evaluating equation (16) with a pressure P of 10 kPa63, a trachea radius rt = 0.0023M0.4 m62, air density, and respiratory volume Vtot = 83M1.06 mL produces a frequency
in Hz as shown as a blue dot-dashed line of Fig. 2a. This trend line is more than an order of magnitude above the experimental data, indicating that Loudon’s assumption of an infinite channel does not well-match the finite channel of the trachea.
