Deep time-delay Markov network for prediction and modeling the stress and emotions state transition
To recognize stress and emotion, most of the existing methods only observe and analyze speech patterns from present-time features. However, an emotion (especially for stress) can change because it was triggered by an event while speaking. To address this issue, we propose a novel method for predicting stress and emotions by analyzing prior emotional states. We named this method the deep time-delay Markov network (DTMN). Structurally, the proposed DTMN contains a hidden Markov model (HMM) and a time-delay neural network (TDNN). We evaluated the effectiveness of the proposed DTMN by comparing it with several state transition methods in predicting an emotional state from time-series (sequences) speech data of the SUSAS dataset. The experimental results show that the proposed DTMN can accurately predict present emotional states by outperforming the baseline systems in terms of the prediction error rate (PER). We then modeled the emotional state transition using a finite Markov chain based on the prediction result. We also conducted an ablation experiment to observe the effect of different HMM values and TDNN parameters on the prediction result and the computational training time of the proposed DTMN.
Emotion plays a vital role in communication. Emotional awareness helps us to better understand the feelings of a communicator. In the 1970s, a psychologist identified six basic emotions: happiness, sadness, disgust, fear, surprise, and anger1. In human life, happiness is the primary purpose to be achieved. Happiness is often defined as a pleasant emotion. In contrast, unhappiness is projected to an unpleasant state, such as sadness, depression, and stress2. In neurobiology science, stress is a situation that triggers a particular biological response that causes hormones to surge throughout the body3. When people are in a stressed condition, it is easy for them to misunderstand intentions or what they would like to communicate and express an abnormal emotion as a reaction. Stress can affect all aspects of a person’s life, including emotions, behaviors, thinking ability, and physical health4. Everyone handles stress in different ways so that the symptoms of stress are also varied. The symptoms of stress can be vague and may be the same as other medical conditions. Hence, it is important to recognize stress early.
The body reveals the stress response through facial expression, body language, and tone of voice. Thus, the facial expression5,6,7,8 and speech of the stressed person9,10,11,12,13 can be used to detect the level of stress14. Since the speech-based stress measurement method is non-invasive, it is convenient for measuring stress. Therefore, this method has become popular and widely studied. The speech-based stress measurement method, also known as stress speech recognition (SSR), uses labeled utterances and learns their patterns to recognize stress12. A large quantity of relevant stress speech data is required in the training phase to enable this system to adapt to real conditions. Unfortunately, stress speech datasets are limited. To this end, many researchers use clustering algorithms to categorize unlabeled stressed speech data based on the similarity of their characteristics.
In this decade, clustering algorithms have successfully categorized stress speech data using an unsupervised approach15,16,17,18. Most of them used a similarity algorithm to compute the distance between data points. However, it was found that these algorithms become inefficient for high-dimensional data due to their computation time and memory usage19, known as the curse of dimensionality. Recently, using a self-learning method to optimize the clustering objective, deep clustering algorithms have addressed the curse of dimensionality20 problem. Deep clustering applies a deep neural network (DNN)-based autoencoder to compactly transform the data from the original space to a lower-dimensional space (embedding space)21,22. By learning in-depth and simultaneously minimizing the error, deep clustering can present an excellent feature representation. However, despite its compactness in representing features, most of the deep clustering algorithms have not yet considered the prior state. In some cases, emotion (especially stress) may change when triggered by an event while speaking23. In this fashion, we argue that the prior emotional states should also be monitored so that the emotion of the speaker can be recognized more accurately. By this approach, we can take advantage of larger sets of contextual information24.
Several studies have successfully modeled emotion based on its state transition23,24,25,26,27. Generally, for predictive modeling or probabilistic forecasting28, the Markov model is the most used because of its convenience in modeling the temporal context in time-series (continuous) data27,29. The hidden Markov model (HMM) models the dependencies between consecutive hidden states. In natural language processing, it was found that there are local dependencies and at a distance. Conservative methods that use the most recent history to perform prediction produce an overfitting result for short-term patterns and miss the important long-term effects30. Thus, capturing the long-term temporal dynamics in-depth is essential for further exploration.
Today, deep neural networks (DNNs) are the most popular deep learning technique because of their superior in-depth learning of complex patterns. DNNs are composed of multiple layers of nonlinear operations that aim to learn features hierarchically, where features in a small temporal context at higher layers are formed using the features at lower layers. To process a wider temporal context, from the initial layer, DNN learns an affine transform for the entire temporal context31. Consequently, DNNs become ineffective for modeling the dependencies of temporal dynamics (long and short temporal contexts)32, such as stressed speech33. In contrast, to handle a long-range temporal dependence, a time-delay neural network (TDNN) creates more large networks from sub-components across time steps31. In such a way, TDNN learns the dependency inter-contexts at small or long temporal scenarios.
To this end, we propose a new framework for predicting and modeling stress and emotions, named the deep time-delay Markov network (DTMN). The DTMN analyses in-depth the stress and emotion speech features by considering the prior emotional states. Structurally, the DTMN contains Markov method, which is handled by HMM and the neural network architecture of TDNN. HMM is trained to generate the transition matrix of emotional states and predict the hidden states at each time step. The TDNN is trained to predict the present hidden state by considering the present feature and prior hidden states. We explicitly use the embedding feature of deep clustering22 as input to the DTMN, which proves able to present a compact feature representation of stress and emotion.
We organized the rest of this paper as follows. In the “Related works” section, we review the existing stress and emotion models and the related works. The “Results” section demonstrates the evaluation results in the prediction task and the modeling of stress and emotion transitions. The prediction result and the state transition model of the stress and emotions are discussed in the “Discussion” section. The “Method” section describes the material and method of the proposed DTMN that consists of the use of the dataset, network settings, baseline systems, and its ablation experiment. Finally, the “Conclusion” section provides the final results and future work.
We demonstrate the effectiveness of the proposed DTMN to predict the present state of stress and emotion and then model their state transition. The proposed DTMN is assigned to predict the state of stress and emotion from the speech data from the SUSAS dataset. The performance of DTMN is evaluated by comparing it with the baseline systems in terms of the prediction error rate (PER). Furthermore, we model the state transition of stress and emotions based on the speech label from the prediction result.
The effectiveness of the proposed DTMN is evaluated in predicting the emotional state of the time-series observations. In this experiment, we set the input and the parameters of DTMN as mentioned in the “DTMN parameters setting” section and the “Baseline systems setting” section, respectively. We run each system independently 10 times, and on average, the evaluation results are summarized in Table 1.
Table 1 shows that BN presents a lower error than KNN. This is because KNN should provide proper scaling among variable time steps, while BN depicts the relationships between variables on each time step in the manner of conditional independencies. However, BN cannot represent the nonlinear functions of state variables. Hence, BN has a higher error rate than HMM. The performance gap between LSTM and HMM shows that in-depth learning of the hidden state is more effective than statistical machine learning. Although the LSTM has learned the long-term temporal context dependencies, many emotional states are hard to determine or even unobservable. The combination between HMM and DNN (such as DMNN and the proposed DTMN) presents a better ability in solving the LSTM’s limitations by demonstrating a lower error rate. By considering the activation patterns over time, the proposed DTMN significantly outperforms the DMNN in predicting the emotional state. The proposed DTMN is a sophisticated emotional state transition model that achieves an average prediction error rate of 8.55%.
In the “Prediction accuracy” section, the proposed DTMN demonstrates an effective result in predicting the stress and emotion by its state transition. This indicates that the proposed DTMN can accurately predict the present state based on the prior states. Furthermore, we use a finite Markov chain to model the pattern of emotion transitions. Since males and females express emotion in different ways57, we present the state transition of males and females in the different diagrams.
The state transition model of stress and emotions. Males and females present a similar emotional state transition model. Tables (a,b) show the transition probability from state i to state j for males and females, respectively.
Figure 1 shows the emotional state transition model. Tables (a) and (b) denote the state transition probability for males and females. \(P_{i,j}\) indicates the transition probability from state i to states j. For instance, \(P_{1,5}\) is the state transition probability from the state “angry” to state “soft” with the probability “0.02” for males and “0.26” for females. Each table shows that the sum of each row is one. As an example, the first row of Table (a) represents that sum of the transition probability from the state “angry” to the other states (angry, high stress, low stress, neutral, and soft) is one. This indicates that the transition matrix is a stochastic process, i.e., \(\sum _{j} P(i,j)=1\). From Tables (a) and (b), it is clear that the highest probabilities of each row and column are diagonal. This indicates that emotions typically do not change in a short time. The current emotional state will be retained if there are no typical effective stimuli. However, the highest sum of each column is “neutral” for males and “soft” for females. This proves that females are more emotional than males. Another surprise is that females are more likely to be “soft”, while males are more likely to angry after stressful conditions, which indicates that gender responds to emotional stress in different reactions, both psychologically and biologically, depending on their background experience, behavioral, and physiological domains.
In this paper, we present a novel framework of stress and emotion prediction and modeling. Structurally, the DTMN consists of a HMM and the TDNN. The HMM is trained to produce the transition probabilities and the hidden states at each time step. TDNN can learn in-depth the hidden representation of HMM by creating more extensive networks from sub-components. In the prediction task, the DTMN is assigned to predict the emotional state of the time-series observations. As shown in Table 1, DTMN can outperform the baseline systems by achieving the lowest prediction error rate. This result indicates that the proposed DTMN overcomes the challenge by predicting the change in emotion accurately while speaking. Moreover, we showed that our method is efficient and effective in predicting stress and emotion.
As mentioned above, emotion can usefully be defined as states elicited by reinforcements. These reinforcements or stimuli can be considered emotional information. As we know, every person can recognize and understand other emotions without any training, and it is too complex to be described by machine learning. Therefore, we argue that there are common patterns of emotional events. In this work, we presume that the cognitive assessments to basic emotional stimuli are the same. Then, we use the five discrete emotional states (high stress, low stress, neutral, soft, and angry) from the SUSAS database and the movements of emotional states taken by the Markov process, as shown in Fig. 1. We represent males and females in different schemes because they express emotion in different ways. Generally, males and females present a similar emotional transition representation. However, there are some fundamental differences between male and female emotional transition tendencies. Females tend to more easily change their emotions, but they have a tendency to longer stress than males. After a stressful period, females tend to become “soft”, while males more easily become “angry”.
