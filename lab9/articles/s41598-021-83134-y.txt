Few-shot pulse wave contour classification based on multi-scale feature extraction
The annotation procedure of pulse wave contour (PWC) is expensive and time-consuming, thereby hindering the formation of large-scale datasets to match the requirements of deep learning. To obtain better results under the condition of few-shot PWC, a small-parameter unit structure and a multi-scale feature-extraction model are proposed. In the small-parameter unit structure, information of adjacent cells is transmitted through state variables. Simultaneously, a forgetting gate is used to update the information and retain long-term dependence of PWC in the form of unit series. The multi-scale feature-extraction model is an integrated model containing three parts. Convolution neural networks are used to extract spatial features of single-period PWC and rhythm features of multi-period PWC. Recursive neural networks are used to retain the long-term dependence features of PWC. Finally, an inference layer is used for classification through extracted features. Classification experiments of cardiovascular diseases are performed on photoplethysmography dataset and continuous non-invasive blood pressure dataset. Results show that the classification accuracy of the multi-scale feature-extraction model on the two datasets respectively can reach 80% and 96%, respectively.
The collection process of pulse wave signals is simple and non-invasive, enabling convenient acquisition of PWC data1,2,3. The classification of PWC can be used to monitor the heart condition. However, no uniform standard exists for marking PWC4. The standard diagnostics of PWC is primarily based on an individual’s different clinical knowledge and experience to define the morphological features. The formed diagnostic results are subjective, which are difficult to be recognized by all experts.
Existing classification methods of PWC can be categorized into two: statistical methods and machine-learning methods5,6. Statistical methods represented by artificial time-frequency domain feature extraction are suitable for stationary sequences7. Machine-learning methods represented by convolution neural networks8,9 (CNN), recursive neural networks10,11 (RNN), and support vector machines12,13 are suitable for complex non-linear sequences. Clinically collected PWCs are non-stationary and time varying14, rendering it suitable for machine-learning methods.
Long short-term memory (LSTM), a variant of RNN, has the ability of mining long-distance time-series data information15. It is extensively used in machine translation16,17, fault diagnosis18,19, speech recognition20,21, and electrocardiogram classification22,23. In literature24, the representation of speech signals from an original network is automatically learned by CNN, and then the temporal representation of features is learned by LSTM; In literature25, the features of wearable sensor data is learned by CNN, and then the time dependence between actions are modeled by LSTM.
The common idea of the above methods is to extract high-dimensional features by CNN and subsequently obtain short-series features through LSTM, which can be used to predict and synthesize time series. PWC is a kind of few-shot data that difficultly meets the training needs of complex deep networks26.
In the present study, a recursive-network unit structure based on LSTM is designed and found to be suitable for few-shot PWC. Compared with LSTM structure, it has fewer parameters and faster training rate. Adjacent unit information is transmitted through state variables, information is updated through a forgetting gate, and the long-term dependence of PWC is retained in the form of unit series. Simultaneously, a multi-scale feature-extraction model adapted to few-shot PWC is proposed. The multi-scale feature-extraction model is an integrated model that extracts features from three angles. The spatial features of single-period PWC and the rhythm features of multi-period PWC are extracted through CNN. The long-term dependence features of PWC are retained through RNN. All extracted features are then combined linearly for classification.
Cardiovascular-disease classification experiments are performed on photoplethysmography (PPG) dataset and continuous non-invasive blood pressure (CNBP) dataset. Experimental results show that the classification accuracy of the multi-scale feature-extraction model can reach 80% and 96%, respectively.
The remaining part is organized as follows. In the ’Materials & Methods’ section, the experimental data are stated, and multi-scale feature-extraction model are proposed. In the ’Results’ section, the process of data pre-processing and experiment are stated in detail. Finally, conclusions are drawn in the ’Discussion’ section.
We use Accuracy(Acc), Sensitivity (Sen), Specificity(Spe), Precision(Pre), and F1-score for model evaluation. The calculation formula for the five evaluation indicators is as follows30:
where TP stands for true positive and is the number of samples predicting abnormal PWC; TN stands for true negative and is the number of samples predicting normal PWC as normal; FP stands for false positive and is the number of samples predicting normal PWC as abnormal; FN stands for false negative and is the number of samples predicting abnormal PWC as normal; Acc represents the overall classification accuracy of the overall model; Sen represents the proportion of abnormal PWC that are matched and measures the model’s ability to recognize abnormal PWC; Spe represents the proportion of normal PWC that are matched and measures the pairing of the classifier, i.e., the ability to recognize normal PWC; and Pre represents the proportion of PWC classified as abnormal that are actually marked as abnormal.
Pulse wave signals collected in clinical settings is easily affected by noise, including motion artifacts, inherent noise of collecting instruments, and power-supply noise. Using end-to-end training directly reduces the classification accuracy. Therefore, the original signals need to be pre-processed before the experiment.
The frequency of pulse wave signals is primarily distributed between 0.5–2 Hz. Motion artifact is primarily caused by breathing, and the respiratory frequency of normal adults is about 0.2–0.3 Hz. The inherent noise of collecting instruments is above 90 Hz. The power supply noise is 50 Hz/60 Hz. Empirical mode decomposition (EMD) is a signal-processing method based on the time-scale features of the data itself without pre-setting any basis functions31. EMD has obvious advantages in dealing with non-stationary and non-linear data. According to the frequency-distribution features of the pulse wave signals, the EMD method is used to remove the noise.
In the process of EMD, cubic spline function is used to interpolate the maximum value sequence and the minimum value sequence to obtain the upper and lower envelopes. The cubic spline interpolation needs to use two adjacent points before and after. Therefore, there will be divergence at the two ends of the data, that is, the derivative of the intrinsic mode-function at the boundary increases, which makes the filtered signal has obvious distortion at the beginning and end. To avoid the transient phenomenon at the beginning and end of the filtered signal, the end points of the curve are added to the spline. The Pearson correlation degree is used to measure the degree of information loss before and after denoising, and the calculation method is shown in equation (16):
where X represents the set of elements arranged in time in the original PWC, Y represents the set of elements arranged in time after denoising, and N represents the number of sample points.
The value interval of Person is [− 1,1]. When a person is close to 1, X and Y have a strong linear correlation, showing that the information loss is relatively small after denoising. In the experiment, only data with a Person coefficient greater than 0.93 after filtering is retained to ensure that the filtered data retains the original information to the greatest extent. The calculation result of the signal Person coefficient in Fig. 6 is 0.99.
Signals collected clinically are actually the slice data of pulse wave signals. Few records of pulse wave database itself exist; not every record has all categories, and even some categories appear only on a few records. In this case, to ensure that categories are not omitted as far as possible, the PWC should be divided separately into beats32. In the experiment, the PWC is divided into cycles according to the trough position. The signal segment of the adjacent valleys is regarded as one PWC cycle. The specific pre-treatment process is shown in Fig. 6.
Network model structure.
The pre-processed PWC is randomly divided into training set and test set at a ratio of 4:1. Under the condition of a certain amount of data, the classification accuracy of the model no longer increases before the number of hidden nodes of the neural network increases to a certain extent33. Therefore, the number of hidden nodes in the recursive network layer is set to 32, the number of kernels in the periodic feature-extraction layer is set to 32 and 64, the number of kernels in the rhythm feature-extraction layer is set to 32 and 64. After verification through multiple experiments, the network training parameters are set, as shown in Table 3.
The number of PWC cycles input of the model is expressed as a unit cycle. An increase in amount of cycles of model input leads to an increase in depth of the recursive network. Furthermore, the proportion of features extracted by the periodic feature-extraction layer and the rhythm feature-extraction layer increase. At the same time, the network dimension increases leads to decreased training speed of the model. To determine the optimal number of unit cycles for a suitable PWC multi-feature scale model, experiments are conducted for different unit cycles. Training set II is used in the experiment, and each group is trained 50 times. The final results are shown in Table 4. According to the table, when the number of unit cycles is 5, the model has the optimum effect.
On the premise of retaining the structure of the pre-processing layer and the reasoning layer, as well as the network parameters, the network layer is changed for comparison experiments. Zhan34 et al. extracted features through CNN for classification. Liu35 et al. extracted PWC timing features through parallel CNN structures, including signal segment features within a period and multi-period features representing cycle relationships; Ghosh36 et al. extracted PWC features based on LSTM to predict systolic and diastolic blood pressure. The training process of different network models is shown in Figure 7.
Changes in classification accuracy of different network training processes.
Performance comparison with other neural network methods under different datasets is shown in Table 5. According to the table, the multi-scale model has good classification performance on dataset I and dataset II.
A small-parameter unit structure and a multi-scale feature-extraction model are proposed to obtain improved results under the condition of few-shot pulse wave contour classification. Cardiovascular-disease classification experiments were carried out on PPG dataset and CNBP dataset. To evaluate the classification performance of the multi-scale feature-extraction model, three different classification methods including single neural network model34, parallel neural network model35, and LSTM model36 were introduced for comparison. Comparative studies show that the multi-scale feature-extraction model outperforms the other classification methods in terms of identification accuracy, stability, and sensitivity, and the multi-scale feature-extraction model consumes less time for training. For the proposed novel PWC classification approach, the model is notably sensitive to the number of unit cycles, and we find that the best unit cycle is five. Also, the multi-scale feature-extraction model depends on the division result of the PWC cycle.
Moreover, (a) the classification problem of few-shot PWC is well handled; (b) owing to the limitation of data volume, only binary classification is carried out; (c) PWC must be pre-processed (including EMD filtering and beat segmentation) before feature learning, which may lead to missing partial information. Finally, given the excellent performance of the multi-scale feature-extraction model in the few-shot PWC experiments, the classification of few-shot PWC is interesting and meaningful to study, and it will be further investigated in our future research.
