Determining the chaotic behaviour of copper prices in the long-term using annual price data
#https://www.nature.com/articles/s41599-017-0060-x
Mineral commodity prices are influenced by economic, technological, psychological, and geopolitical factors. Stochastic approaches, and time series and econometric techniques have been used to represent the dynamics of mineral commodity markets and predict prices. However, these techniques cannot provide a comprehensive representation of market dynamics because they do not recognise the relationship between these factors over time, and they are unable to capture both the evolution and the cumulative effects of these factors on prices. Stability of motion and chaos theories can detect sensitivity to initial conditions, and therefore the evolutionary patterns allowing a proper understanding and representation of mineral commodity market dynamics. Most of the techniques used to assess chaos require a colossal amount of data, so the use of small data sets to assess chaos has been largely criticised. Nevertheless, by definition, the dynamics of a chaotic system remain at different scales owing to its self-organisation features that exhibit ordered patterns in the absence of codes or rules. Therefore, any deterministic chaotic behaviour of mineral commodity prices can be captured by using small data sets if a detailed qualitative and quantitative analysis are carried out. This paper examines the chaotic behaviour of annual copper prices between 1900 and 2015. To do so, we combine chaos theory, stability of motion and statistical techniques to reconstruct the long-term dynamics of copper prices. First, we examine the time dependency and the presence of a strange attractor by a visual analysis of the time series and phase space reconstruction based on Takens’ theorem and determine embedding parameters. Then we examine the dynamic characteristics of the system which assesses its complexity and regularity patterns to measure the system’s entropy. Finally, we calculate the largest Lyapunov exponent λ to assess the sensitivity to initial conditions and determine chaotic behaviour supported by a surrogate test. We find that annual copper prices have a chaotic behaviour embedded in a high-dimensional space and short time delay. The study suggests that copper prices exhibit only a single state of low prices, which fluctuate through transitional periods of high prices. It challenges the assertion that metal markets have fluctuated over four major super cycles and debate the adequacy of stochastic and econometric models for representing mineral commodity market behaviour.
This study recommends that the use of chaotic behaviour improves our understanding of mineral commodity markets and narrows the data searching, processing and monitoring requirements for forecasting. Therefore, it improves the performance of traditional techniques for selecting key factors that influence the market dynamics, and may also be used to select the most suitable algorithm for forecasting prices.
The impression that small causes may have a significant effect through time is known as “sensitivity dependence to initial conditions” (Lorenz, 1995) and has long been used to explain historical events and their effects through time. This phenomenon was formalised in 1962 by chaos theory and since then the belief in random behaviour through time has been questioned, both in nature and in markets (Debreu, 1991; Tapia Cortez et al., 2017; Thom and Chumbley, 1983; Wolfram, 2002). Sensitivity to changes in the initial conditions is the most important characteristic of chaotic behaviour in complex dynamic systems (Showalter and Hamilton, 2015). It is demonstrated by the fast exponential growth of the divergence between two near initial trajectories of the system across time known as strange attractors (Azar and Vaidyanathan, 2015, p 10; Becks et al., 2005; Guegan, 2009; Hegger et al., 1999; Kodba et al., 2005; Navarro–Urrios et al., 2017; Panas, 2001; Panas and Ninni, 2000; Reynolds et al., 2016; Rosenstein et al., 1993; Savi, 2005; Vlad et al., 2010; Wernecke et al., 2017; Yamamoto, 1999). Strange attractors contain the state of the system and plot its motion in the form of infinite non-periodic unique orbits that never close themselves. They occur in parallel sets with a gap between any two members of the set. The most useful tool for examining the sensitivity to initial conditions and detecting the presence of chaotic behaviour has been the widely documented largest Lyapunov exponent (λ) method (Becks et al., 2005; Chen et al., 2016; Gaspard et al., 1998; Gottwald, 2009; Kodba et al., 2005; Navarro–Urrios et al., 2017; Panas, 2001; Panas and Ninni, 2000; Perc, 2006; Reynolds et al., 2016; Rosenstein et al., 1993; Savi, 2005; Showalter and Hamilton, 2015; Wernecke et al., 2017; Zhong et al., 2017). According to a large body of literature,, large datasets are required to assess chaotic behaviour, but this is often not achievable due to cost, technical or temporal limitations (Abraham et al., 1986; Kantz, 1994; Rosenstein et al., 1993). Data scarcity can limit the power of the method to calculate λ (Abraham et al., 1986; Kantz, 1994). However, a method has been introduced by Rosenstein et al. (1993) to overcome this limitation, allowing sufficiently accurate and precise calculations of λ in small datasets (Becks et al., 2005; Graham et al., 2007; Kantz, 1994; Navarro–Urrios et al., 2017). Previous studies have proven the suitability and reliability of small data sets with 50 observations in regards to their calculation of λ for assessing chaotic behaviour of complex dynamic systems (Becks et al., 2005; Blank, 1991; Chen et al., 2016; Gaspard et al., 1998; Navarro–Urrios et al., 2017; Raffalt et al., 2017; Reynolds et al., 2016; Sivakumar, 2000). Moreover, the same methodology has been successfully applied to study the complexity of various dynamic systems, including electrocardiograms, human gait recording, and laser droplet generation (Krese et al., 2010; Perc, 2005a, 2005b).
Data length has been a critical issue for demonstrating the nonlinear dynamics of signals generated in social and environmental sciences. The introduction of the approximate entropy (ApEn) by Pincus (1991) and the sample entropy (SampEn) by Richman and Moorman (2000) have alleviated this restriction (Ferrario et al., 2006; Yentes et al., 2013). Due to their statistical and de facto noise filtering properties (Pincus, 1995), ApEn and SampEn have proven their applicability and reliability for assessing complexity (or regularity) in small data sets (Chen et al., 2006; Ferrario et al., 2006; Molina-Picó et al., 2011; Pincus, 1995, 2001; Sarlabous et al., 2010; Yentes et al., 2013). ApEn is robust to outliers and is nearly unaffected by noise which provides a good confidence at time to apply the algorithm to small data set of at least 50 samples (Molina-Picó et al., 2011; Pincus, 1995, 2001; Sarlabous et al., 2010; Yentes et al., 2013). SampEn is even less sensitivity to the length of data sets and provides more consistent results which being also reliable to be used in small data sets (Chen et al., 2006; Ferrario et al., 2006; Lake et al., 2002; Yentes et al., 2013). It is important to note that ApEn and SampEn have also been used as a metric to evidence the chaotic behaviour of time series that presents positive λ (Cencini and Ginelli, 2013; Chen et al., 2016; Gaspard et al., 1998; Kaplan et al., 1991; Pincus, 1995; Sanei, 2013; Schreiber and Kantz, 1995)
The chaotic behaviour of the price sequence of several mineral commodities has been assessed previously, however these studies (Abdullah and Zeng, 2010; He et al., 2015; Panas, 2001; Panas and Ninni, 2000) have been limited to sample periods of 15 years or less, and used daily or monthly prices. It is important to verify the time-related behaviour of mineral commodity prices in the long-term by using annual data, due to the impact of economic decisions, technological and regulatory changes which can be observed over years (Bernanke, 2013; Slade, 2015; Yellen, 2013). Changes in key variables driving the global economy such as interest rate, monetary policy, taxes, and federal debts and investment levels may have effects on the economy at least three quarters ahead. The evolution of economy, due to the changes in key variables, becomes even more extensive during financial crisis where recovery may take up to 3 years, and they can affect the economy for up to 6 years. Changes in these variables generate extensive speculation that also affects commodity prices (Alquist and Kilian, 2010; Bernanke, 2013, 2010; Calvo, 2008; Frankel, 2014; Friedman, 1988, 1968; Gürkaynak et al., 2005; Hoover, 1985; Lederman and Maloney, 2007; Yellen, 2013).
The long term data availability for copper prices traded in open market dates back from 1877, when the London Metal Exchange (LME) was established (Cuddington and Jerrett, 2008); hence, at best, only 139 annual observations can be used, and obtaining at least 2000 observations to assess chaos as suggested by Gottwald (2009) is not feasible. Therefore, using annual observations for assessing the long term chaotic dynamics of economic time series such as mineral commodity prices can only be assessed with small datasets because the potential sample period is limited to available reliable historical market data (Huffaker, 2010; Kantz, 1994; Ramsey et al., 1990). The literature shows that the long term copper prices behaviour has been determined using between 107 and 137 observations in annual basis (Ahrens and Sharma, 1997; Chen, 2010; Cuddington, 2010; Svedberg and Tilton, 2006). Thus, the use of 116 observations as presented in this study is consistent with previous research.
We investigate the chaotic behaviour of annual mean copper prices between 1900 and 2015. First, we examine the time dependency and the presence of a strange attractor by a visual analysis of the time series and phase space reconstruction based on Takens’ theorem (Takens, 1981). Then, we examine the dynamic characteristics of the system assessing its stationarity and determinism features to guarantee the quality and relevance of invariant tests such as λ (Ahrens and Sharma, 1997; Perc, 2006). Subsequently, we investigate the complexity of the annual copper prices time series (Original) by calculating Approximate (Kaplan et al., 1991; Pincus, 1995, 1991) and Sample Entropy (Lake et al., 2002; Richman and Moorman, 2000) of the system. Based on the methodology used for Castiglioni and Di Rienzo (2008), Lu et al. (2008) and Yentes et al. (2013), we characterise the behaviour and generation process of the time series (Original) by comparing its entropy with the entropy of well understood chaotic, periodic and stochastic systems. A periodic time series was generated using the Logistic Maps (Eq. 13) using α equals to 3.4. A chaotic time series was generated using the Logistic Maps (Eq. 13) and α equals to 4.0. Two stochastic time series (Experimental) were generated applying a random function arrangement over the “Original” data sets (using Microsoft Excel). All data sets contain 116 samples. Finally, we assess sensitivity to initial conditions and determine chaotic behaviour calculating λ using a simple method (Rosenstein et al., 1993) that has been widely used to determine chaotic behaviour (Navarro–Urrios et al., 2017). It does not require an accurate knowledge of the embedding parameters to reconstruct the phase space so called embedding dimension (m) and time delay (τ). However, a proper choice of both parameters is important to assure the reliability of the assessment (Cao, 1997; Huffaker, 2010; Kumar et al. 2004). Thus, we calculateτ by the average mutual information technique (Becks et al., 2005; Chen et al., 2016; Hegger et al., 1999; Huffaker, 2010; Kumar et al., 2004; Nichols and Nichols, 2001; Perc, 2006; Raffalt et al., 2017), m by the false nearest neighbours method (Becks et al., 2005; Cao, 1997; Chen et al., 2016; Hegger et al., 1999; Huffaker, 2010; Kennel et al., 1992; Nichols and Nichols, 2001; Raffalt et al., 2017; Reynolds et al., 2016). To confirm embedding parameters combinations, we also calculate the Theiler window (ω) by the space-time separation plot technique (Provenzale et al., 1992). Results obtained from the λ were supported by a surrogate test which was conducted based on the methodology describe on Cutler and Kaplan (1997), Das and Das (2007), Graham et al. (2007), Hegger et al. (1999), Kumar et al. (2004), Miller et al. (2006), Raffalt et al. (2017), So et al. 1996 and Theiler et al. (1992). All analyses were performed using the software R® (R Development Core Team 2015) version R × 64 3.3.3 with a statistical confidence level of at least 95%.
We reveal that annual copper price time series do not exhibit periodic behaviour and are not generated by a stochastic process. In addition, we observe the presence of a strange attractor describing an orbit running through a “stable” low-price state only interrupted by several years of price increases. We name these fluctuations “price transition periods” which should be addressed as exceptional adjustment periods rather than cycles. We demonstrate that a small dataset of annual mineral commodity prices with 116 annual observations is adequate for assessing chaotic behaviour via the Lyapunov exponent λ. We observe the chaotic behaviour of copper prices in a high embedding dimension (m) of seven variables and short time delay (τ) of two periods. We reveal that variables driving prices are time related, evolve in a cause and effect manner, and effects propagate over time. In our case of study, we show that mineral commodity price fluctuations have cumulative effects over time where changes affect not only current states but also future states that then become the starting point for the next price change describing a continuous temporal relationship. These findings contribute to understanding the long-term nature of mineral commodity prices.
A visual analysis is required for the early recognition of common faults in experimental and real data such as breaks, drifts or rare events (Kantz and Schreiber, 2004). The visual analysis provides information about variation amplitude, possible trends and pattern evolution (McCullough et al., 2007; Perc, 2006). To investigate the temporal relation between “current” and “past” events we reconstruct the phase space using the time delay embedding theorem proved by Takens in 1981 (Huke, 2006; Kennel et al., 1992; Perc, 2006). Takens’ theorem is one of the most well-known, and has been widely used in tests to recognise chaotic behaviour in time series. It asserts that the orbits of chaotic systems are attracted to one specific limited area of the phase space, so-called “strange attractors”, and that changes of their shape provide significant information hidden inside the dynamics of the system (Huke, 2006; Perc, 2006; Povinelli, 2001; Takens, 1981). Recreating the dynamics of the entire system by reconstructing the phase space dimension from a single scalar measurement “may appear somewhat mystic” (Kodba et al., 2005), due to its unexpected results. However, Takens’ theorem proved that if, at time t, only the value of a variable x is known, at time t+τ the measurement x will implicitly carry not only information of x at time t, but also of other variables of the system at time t (Perc, 2006).
In Fig. 1, we plot the copper price time series, with the original evolution appearing in Fig. 1a, and the phase space reconstruction in Fig. 1b, τ = 1 at the left side and τ = 2 in Fig. 1c. From the original evolution (Fig. 1a), we identify two behaviours bounded by price trends change (stable and up-down) evolving in a similar manner. We observe that the low-price trails are connected by high-price transitional periods describing an orbit running through a “stable” low-price state that moves to a more “volatile” high-price state for a short period and then returns to the low-price state (Figs. 1b and 1c).
Annual copper real prices base 2012 = 100. a Evolution between 1900 and 2015 flagged by major price state and trends. Data includes remarkable economic and financial events in the period (Hong et al., 1996; Radetzki, 2009; Slade, 2015; Tapia Cortez et al., 2017; The Federal Reserve, 2017). During the first 18 years, prices sharply rise for 4 years until reaching the maximum value. Then, prices fall for longer periods and remain fluctuating at low level until the next price rising attempt. The next price rally extended for 3 years whereupon prices fall dramatically to the lowest level of the time series. Low prices during the following 44 years shows that three sharp price rising trends evolving between three to 5 years. After reaching the maximum value of the rally, prices strongly decrease and remain fluctuating at low level for about eight to 10 years. This is a similar pattern exhibited during high prices period; however, it is much longer. High price pattern repeats between 1964 and 1975 exhibiting the two price rise attempts followed by the sharp falls. Then, between 1975 and 2005, low price pattern comes back showing the three short prices growing periods followed by larger price decreasing and fluctuation periods. Finally, between 2006 and 2015 the high prices dynamic is repeated. The two price ascents evolved in a shorter period; however, the characteristic sudden prices decline is also displayed. b Time delay plot (τ = 1, m = 2) and (c) Time delay plot (τ = 2, m = 2). Values heuristically chosen. As the scale of the time series is annual (Δt = 1 year), τ = 1 and τ = 2 are small enough and appropriate to cover the dynamics of the system were the effects of changes of main macroeconomic variables can be perceived in the economy at from three quarter up to 6 years (Alquist and Kilian, 2010; Bernanke, 2013, 2010; Calvo, 2008; Frankel, 2014; Friedman, 1988, 1968; Gürkaynak et al., 2005; Hoover, 1985; Lederman and Maloney, 2007; Yellen, 2013). In both cases, τ = 1 and τ = 2, we identify five trails named TS_01, TS_02, TS_03, TS_04 and TS_05 which are grouped in two states: low-prices (TS_02 and TS_04) and high-prices (TS_01, TS_03 and TS_05)
Our visual analysis supports the assertion of the long-term copper prices which have a single low-price state that eventually fluctuates over the short high-price adjustment states that we name “price transition periods”. This behaviour is consistent with the price-demand inelasticity of the mining industry, and in particular because of the significant time delay between investment and production. From Fig. 1a, we note that global copper price decreases coincide with inflation and recessions in the world’s largest economy, the United States (for more details see Supplementary Fig. 1).
Stationarity and determinism properties must be tested to ensure the suitability of the analysis and guarantee the quality and relevance of invariant tests such as λ (Ahrens and Sharma, 1997; Perc, 2006). Many economic and financial time series such as exchange rates, asset prices and macroeconomic aggregates, such as real Gross Domestic Product, are non-stationary. However, they may become stationary computing the differences between consecutive observations by using one of the two differencing techniques: first differencing or transformation (Hyndman and Athanasopoulos, 2013; Zivot and Wang, 2007). Establishing the stationarity of a system is a complex task and almost impossible to determine by a single test. As the null hypothesis (H0) is commonly rejected for large sampling sizes (Alquist et al., 2011), rejecting H0 from a single test may not be assumed as a system’s behaviour and complementary tests are require (Kantz and Schreiber, 2004). We performed three tests to determine the stationarity of the system. The Augmented Dickey–Fuller test rejected H0 for the first differencing (ρ -value < 0.001, significance at the 1% level). The Phillips–Perron test rejected H0 in level (ρ -value < 0.001, significance at the 5% level). The Kwiatkowski–Phillips–Schmidt–Shin test rejected H0 in level (ρ -value > 0.1, significance at the 5% level). We therefore reject the null hypothesis and conclude that the series is stationary.
We evaluate the uniqueness of the solution of the reconstructed vector in the phase space to distinguish between a deterministic chaos and the irregular random behaviour (Kaplan, 1994; Kaplan and Glass, 1992; Kodba et al., 2005; Perc, 2006). We assess the deterministic behaviour by two tests. Firstly, we use a test (Kaplan, 1994) which is built on a very simple question: If two points zj and zk are very close together, are their images zj+1 and zk+1 also close together? (Kaplan, 1994). This test examines the continuity of the orbits of the phase space reconstructed from the delayed original series and measures the separation between E-statistics of the original time series and a set of surrogates created. We determine the level of determinism of the time series by examining the percentage of overlapping E-statistics between the original time series and its surrogates in a barplot. We observe a noticeable separation between them which leads us to conclude that the signal is deterministic (see Supplementary Fig. 1). Secondly, we use the false nearest neighbours method which uses the function E2(d) (Cao, 1997) that can distinguish between deterministic and stochastic signals. Thus, while stochastic signals exhibit invariant E2(d) values approximately equal to one, for all values of m, E2(d) values fluctuate for deterministic signals and diverge from one (Cao, 1997) (see Supplementary Fig. 5c). We assert the deterministic features of the time series by the high determinist level of the E-statistic and fluctuations of E2(d) values.
The complexity of systems can be used to distinguish between periodic, chaotic and genuine random behaviour of the systems related to biology and social sciences. Entropy is a statistical tool to measure the complexity of nonlinear dynamics systems (Balasubramanian et al., 2015; Boulamanti and Moya, 2016; Castiglioni and Di Rienzo, 2008; Chen et al., 2006; Ferrario et al., 2006; Kantz and Schreiber, 2004; Kaplan et al., 1991; Kristoufek and Vosvrda, 2014; Lu et al., 2008; Molina-Picó et al., 2011; Pincus, 1995; Richman and Moorman, 2000; Sanei, 2013). In dynamic systems (often chaotic) (Pincus, 1995) entropy is known as the rate of new information generation (Lake et al., 2002; Richman and Moorman, 2000) apprising the amount of information required to predict future state of the system (Kaplan et al., 1991). In theory, periodic systems are less complex having the lower entropy, and random noise systems are more complex and less predictable having the higher entropy and chaotic systems present intermediate values of entropy (Ferrario et al., 2006; Kaplan et al., 1991; Pincus, 1995; Sarlabous et al., 2010; Yentes et al., 2013). Entropy measures the conditional probability that in two similar sequences samples embedded in a dimension µ remain similar in the next sample µ + 1 within a threshold tolerance r (Castiglioni and Di Rienzo, 2008; Lake et al., 2002; Lu et al., 2008; Pincus, 1995, 1991; Sarlabous et al., 2010; Yentes et al., 2013). The capacity to characterise the behaviour of a time series without need of a previous established hypothesis regarding the genesis of the system (Ferrario et al., 2006) is perhaps its main feature.
Systems complexity has been associated to the presence of chaotic patterns. It reflects systems’ flexibility and capacity to adopt a wide range of behaviours to adapt to unpredictable environmental changes (Lipsitz, 2002; Lipsitz and Goldberger, 1992). Complex systems present coordinated movements and an evolutive learning and development process (Yentes et al., 2013). These are prominent features to assess on systems involving human being such as markets behaviour. The development, adaptation and evolution of human social learning and cognitive skills in the economic environment is based on experiences acquired from environmental stimulus through time. These skills are crucial for setting perception, preferences and the decision-making process of humans interacting into the economic environment (Baker et al., 2017; Bechara and Damasio, 2005; de Bot et al., 2007; Frederick, 2005; Fryer and Jackson, 2003; Glowacki and Molleman, 2017; Kenrick et al., 2009; Lefebvre et al., 2017; Smith, 1991; Vriend, 1996).
An appropriate value for µ was estimated using the AMI and FNN (Lu et al., 2008). We determine threshold r values via the maximum ApEn (ApEnMax) obtained from the maximum r (rMax). Thus, we investigate ApEn outputs for combination of values 2 ≤ µ ≤ 5 and 0.1 ≤ r ≤ 0.9 (Lake et al., 2002; Sarlabous et al., 2010; Yentes et al., 2013). Using the chaotic Logistic Map data set, for µ = 2 ApEnMax was calculated at 0.65 and rMax at 0.32. For µ = 3 ApEnMax was calculated at 0.60 and rMax at 0.44. Results show that ApEn and SampEn are sensitive to large µ values of “experimental” data sets. However, results from the Logistic Map (periodic and chaotic), are consistent using different µ values which is congruent with previous studies (Ferrario et al., 2006; Richman and Moorman, 2000; Yentes et al., 2013) providing a solid base of comparison. For µ = 2, results are consistent for the Logistic Map (periodic and chaotic) for all r values. For the “Original” time series, results are consistent for r values between 0.20 and rmax. For the “Experimental” time series, results are only consistent for r values greater than 0.5. This pattern only reflects the design of both algorithms, while values decreases while r increases (Lu et al., 2008; Richman and Moorman, 2000) for the SampEn, values increase steadily until reach rMax and then decrease as r increases (Castiglioni and Di Rienzo, 2008) for the ApEn (Fig. 2 and Supplementary Fig. 3).
Time Series ApEn and SampEn. For both, ApEn and SampEn, periodic process reports smaller values, stochastic process higher values that can go toward infinity for the SampEn and chaotic systems reports intermediate values. Consistency of entropy results is measure by comparing the relative distance between ApEn and SampEn values obtained from each data sets for different setting of r and m. a ApEn (2, 0.1 ≤ r ≤ 0.9, 116) random times series move apart from the chaotic behaviour. Original copper prices show values closer to chaotic behaviour at 0.3 ≤ r ≤ 0.5. b ApEn (3, 0.1 ≤ r ≤ 0.9, 116) random time series move apart from chaotic behaviour. Original dataset shows values close to chaotic behaviour for 0.35 ≤ r ≤ 0.47. However, there is not possible to reach any conclusion due to the erratic behaviour of random and original time series. c SampEn (2, 0.1 ≤ r ≤ 0.9, 116) random times series move apart from the chaotic behaviour. Values of original copper prices are closer chaotic behaviour at 0.3 ≤ r ≤ 0.44 which is consistent with the selection of rmax. d SampEn (3, 0.1 ≤ r ≤ 0.9, 116) values of random times series move describe and erratic shape moving through infinity at small r which is characteristic of stochastic systems. Original dataset values are close to chaotic behaviour for 0.25 ≤ r ≤ 0.4. e AppEn and SampEn (2, 0.32, 116) and f AppEn and SampEn (3, 0.44, 116). Chaotic system and original times series show high similarities which are intensified by the consistency of both tests exhibiting almost the same results. Random times series exhibit divergent values for both tests and largest errors compare to chaotic and original time series. SampEn shows higher values compare to ApEn which can be the result of limitations to assess short stochastic datasets
We selected SampEn because it is more reliable for assessing small data sets (Lake et al., 2002; Richman and Moorman, 2000; Yentes et al., 2013) and more consistency exhibited within assessed time series (Fig. 2 and Supplementary Fig. 3). SampEn values for µ = 2 and 0.1 ≤ r ≤ 0.4 are shown in Table 1. To facilitate values comparison, rMax and r ≥ 0.25 of the original and chaotic time series are highlighted in blue and light blue, respectively. We concluded that the original copper price time series exhibits chaotic patterns similar with the chaotic Logistic Map. Thus, we assert that the time series was not generated by a stochastic process neither has periodic behaviour. This finding reaffirms our assertion that copper prices do not exhibit periodic behaviour fluctuating in super cycles and the debatable adequacy of stochastic models for representing mineral commodity prices (Giles, 2004; Mandelbrot, 1963; Sanei, 2013; Watkins and McAleer, 2004).
To examine chaotic behaviour we calculate λ using a simple method (Rosenstein et al., 1993) that does not require an accurate knowledge of the embedding parameters to reconstruct the phase space. However, considering the symbiotic relationship and mutual assistance between m and τ where shorter τ can be generally compensated with a larger m, a proper choice of both parameters is essential (Cao, 1997; Huffaker, 2010; Kumar et al., 2004; Nichols and Nichols, 2001) for an adequate reconstruction of the attractor governing the system. The product between τ and m, the so-called Theiler window (ω) is an additional and useful tool for setting embedding parameters. The embedding vector ω represents the time span that can be used for an appropriate and flexible selection of τ and m (Hegger et al., 1999; Kumar et al., 2004; Provenzale et al., 1992).
We note that values greater or equal than one are appropriate values for τ which is also consistent with the strange attractor observed at τ = 1 (Fig. 1b) and τ = 2 (Fig. 1c). Using the false nearest neighbours method (Becks et al., 2005; Chen et al., 2016; Hegger et al., 1999; Huffaker, 2010; Kennel et al., 1992; Nichols and Nichols, 2001; Raffalt et al., 2017; Reynolds et al., 2016), we observe that m = 7 is the optimum value. However, as this method is based on some subjective and criticisable assumptions such as the heuristic tolerance R
t
 (Cao, 1997) we conduct a second test. Using a false nearest neighbours method developed by Cao (1997) we also observe that m = 7 is the optimum value. Using a phase separation plot (Provenzale et al., 1992), we note that a ω is ~14 are consistent with the range of combination of m and τ values. It allows us to examine λ testing additional combinations of m and τ(m = 7, τ ≥ 1).
The Lyapunov exponent λ has been widely used to examine the sensitivity to initial conditions and detect the presence of chaotic behaviour (Becks et al., 2005; Chen et al., 2016; Cvitanović et al., 2013; Gaspard et al., 1998; Gottwald, 2009; Graham et al., 2007; Kodba et al., 2005; Navarro-Urrios et al., 2017; Panas, 2001; Panas and Ninni, 2000; Perc, 2006; Pincus, 1995; Raffalt et al., 2017; Reynolds et al., 2016; Rosenstein et al., 1993; Savi, 2005; Wernecke et al., 2017; Zhong et al., 2017) as it quantifies the exponential divergence of nearby trajectories between initial close space-states (Supplementary Fig. 3). Sensitivity to the initial conditions is asserted by the rapid exponential divergence of initially close trajectories through time (Becks et al., 2005; Chen and Aihara, 1995; Chen et al., 2016; Cvitanović et al., 2013; Graham et al., 2007; Kodba et al., 2005; Navarro-Urrios et al., 2017; Panas and Ninni, 2000; Perc, 2006; Pincus, 1995; Raffalt et al., 2017; Reynolds et al., 2016; Rosenstein et al., 1993; Savi, 2005; Wernecke et al., 2017). Thus, if at least one positive λ exists, the chaotic behaviour of the system is presumed (Supplementary Table 2).
It can be asserted that the chaotic behaviour of a data set should be assessed by generating several trajectories starting from a given point surrounded by a number of initial conditions. However, this methodology is only true for theoretical or ideal chaotic systems, theoretical stochastic dynamic models or for elementary models of well-known chaotic behaviour represented by a set of differential equations or time-delay models that reduce the complexity of their dynamic behaviour (Fradkov and Evans, 2005; Guegan, 2009; Vlad et al., 2010). In the absence of an a priori analytical model, or if little insight of the system is available, a proper assessment of m and τ of the time series is required to describe its dynamics. In economics time series, a single time series trajectory is often the main and solely available source of information describing systems dynamics. Thus, to gain knowledge of its dynamics and evaluate whether it has chaotic behaviour, the phase space should be reconstructed to verify the presence of an estranged attractor embedded on certain dimension m and time delay τ to calculate λ and confirm the presences of chaos (Abraham et al., 1986; Becks et al., 2005; Fradkov and Evans, 2005; Guegan, 2009; Nichols and Nichols, 2001; Pincus, 1991; Reynolds et al., 2016; Rosenstein et al., 1993; Vlad et al., 2010; Wolf et al., 1985).
Experimental series of complex systems involving biological, physics and social sciences are constrained by using short data sets, because of their technical, temporal or physiological restrictions (Becks et al., 2005; Ferrario et al., 2006; Kaplan, 1994; Nichols and Nichols, 2001; Pincus, 1995; Ramsey et al., 1990; Yentes et al., 2013). Although several attempts have been made to describe the copper price dynamics, there is not yet a mathematical time delay model or a set of differential equations describing its long-term behaviour (annual base) in the last century. Thus, copper price behaviour using experimental data sets should be carried out by analysing the invariant elements of the systems, such as λ, directly from the data sets. The calculation of λ to determines chaotic behaviour of dynamic systems that occurs in nature (biology, physics and social sciences) has been largely and well documented in the literature even for data sets small as 50 observations (Blank, 1991; Chen et al., 2016; Ferrario et al., 2006; Gaspard et al., 1998; Gottwald, 2009; Kaplan and Glass, 1992; Navarro-Urrios et al., 2017; Nichols and Nichols, 2001; Panas, 2001; Panas and Ninni, 2000; Pincus, 1995; Raffalt et al., 2017; Reynolds et al., 2016; Wernecke et al., 2017; Wolf et al., 1985).
We calculate λ based on the optimum m and τ values calculated (m = 7, τ ≥ 1), as well as for different combinations of 3 ≤ m ≤ 8 and 1 ≤ τ ≤ 4 close to ω is ~14. Possible combinations are highlighted in light blue (Table 2). Using embedded parameters m = 7 and τ = 2 we calculate λ = 0.4823 and is highlighted in blue. For m = 8 and the combination of high m and τ was not possible to calculate λ due to the lack of neighbours (Values in white on Table 2). It reflects the loss of sensitivity of the systems at high embedding dimension and long-time delay. For all remaining possible combinations we calculate λ > 0. However, to confirm the chaotic behaviour of each combination of m and τ that has the potential to reconstruct the dynamics of the systems, we investigate the evolution of perturbations of nonlinear dynamics and instability analysing the shape of the Lyapunov spectrum using the 'ln(divergence)' vs. time plot (Constantoudis and Theodorakopoulos, 1997; Hegger et al., 1999; Reynolds et al., 2016; Rosenstein et al., 1993) (Fig. 3) and assess the nature of time series fluctuations and the statistical significance of the results via surrogate analysis (Cencini and Ginelli, 2013; Kumar et al., 2004; Miller et al., 2006; Raffalt et al., 2017; So et al., 1996; Theiler et al., 1992) (Supplementary Table 3).
ln 'divergence' vs. time plot. a Analysis of τ = 1. All m values are appropriate. b Analysis of τ = 2. m = 5 and m = 5 are doubtful. m = 3, 4, and 7 are appropriate. c Analysis of τ = 3. All combinations are rejected
We plot the number of iterations Δt in the x axis vs. the natural logarithm of error divergence 〈In d
j
(i)〉 in the y axis where each slope of lines is proportional to λ (Fig. 3). Chaos behaviour exists when the curves exhibit an “exponential divergence of initially close state-space trajectories” (Navarro–Urrios et al., 2017; Reynolds et al., 2016) and positive slope reflecting the exponential nature of the test (Rosenstein et al., 1993). Stochastic or quasi-periodic systems exhibits sudden jumps from small separation of the initial time (t = 0), and curves are mostly flat (Rosenstein et al., 1993). We reject chaotic behaviour for all possible combinations of τ ≥ 3, due to incongruent pattern exhibited (Fig. 3c). For m = 5 and τ = 2, and for m = 6 and τ = 2, chaotic behaviour is doubtful because, although there is initial exponential divergence trajectories at close state-space, curves continue to grow that can be related to a power law. Thus, the adequacy of results should be confirmed by a surrogate analysis. For all combinations of τ = 1 a chaotic behaviour could exist (Fig. 3a). However, as short delay of one tend to concentrate all delayed vectors around the diagonal of the embedding space that yield in a strong correlation between them (Hegger et al., 1999; Navarro–Urrios et al., 2017; Rosenstein et al., 1993), a surrogate analysis is required to validate the suggested behaviour. For τ = 2 and m = 3,4 and 7 a chaotic behaviour is suggested as we observe that initially close state-space trajectories diverge in an exponential manner and the presence of a positive slope (Hegger et al., 1999; Navarro–Urrios et al., 2017; Reynolds et al., 2016; Rosenstein et al., 1993) (Fig. 3b).
Surrogate analysis consisted in the creation of random datasets (surrogates) that preserve the statistical properties of the original times series that can be objectively assessed using the same techniques. The relevance of this method for assessing the reliability for our results leads in the fact that the statistical significance of the test can be measured by comparing both outputs the original dataset and surrogates to estimate the statistical probability that observed chaotic behaviour could arise from linear stochastic process modelled by the surrogates (Raffalt et al., 2017; So et al., 1996; Theiler and Prichard, 1997). We construct 50 surrogates using the Theiler’s amplitude adjusted Fourier transform algorithm (Graham et al., 2007; Hegger et al., 1999; Kumar et al., 2004; Theiler et al., 1992). We calculate λ of surrogates (Das and Das, 2007) for all combinations of 3 ≤ m ≤ 7 and 1 ≤ τ ≤ 2 and define their significance by calculating the p-value (Eq. 24). We observe that, except for m = 3, all λ calculated for τ = 1 are bellow of 95% confidence interval of λ calculated on the surrogates as, S < 2 and ρ-value > 0.05. On the other hand, all λ calculated for τ = 2 are above the 95% confidence interval of λ calculated on the surrogates as S is always greater than 2 and ρ-values are close to zero (Supplementary Table 3).
The surrogate analysis at statistical confidence level of at least 95% confirms the existence of more than one positive λ, and a Lyapunov spectrum describing divergent trajectories at initially close state-space evolving in an exponential manner with positive slope. These findings provides us with sufficient evidence to presume the chaotic behaviour of the systems (Becks et al., 2005; Kantz and Schreiber, 2004; Kodba et al., 2005; Panas, 2001; Perc, 2006; Raffalt et al., 2017; Rosenstein et al., 1993; Savi, 2005). Thus, we confirm sensitivity to initial conditions and chaotic behaviour of the time series embedded in a high dimension (m = 7) and short time delay (τ = 2). We have also found evidence that the system might present chaotic behaviour embedded in the same short time delay (τ = 2) and 3 ≤ m ≤ 6 (Table 2).
We prove that small datasets of 116 observations can be used to investigate the chaotic behaviour of mineral commodity prices by using the Lyapunov exponent λ method (Becks et al., 2005; Blank, 1991; Chen et al., 2016; Gaspard et al., 1998; Gottwald, 2009; Kodba et al., 2005; Navarro–Urrios et al., 2017; Panas, 2001; Panas and Ninni, 2000; Perc, 2006; Raffalt et al., 2017; Reynolds et al., 2016; Rosenstein et al., 1993; Savi, 2005; Showalter and Hamilton, 2015; Sivakumar, 2000; Wernecke et al., 2017; Zhong et al., 2017) using copper as a representative mineral. This finding is important for understanding long-term patterns of mineral commodity prices as available annual data is limited. We find that the copper price dynamic is embedded in a relative high dimension m = 7 and, in compensation, in a short time delay τ = 2. This outline may be further explored and used for improving mineral commodity price forecasting models. If used as inputs, these parameters may simplify the forecasting task by increasing our understanding of mineral commodity markets and narrowing the data searching, processing and monitoring requirements. Our study provides appropriate guidelines for the inclusion of time-related variables in datasets in the form of delayed features which might improve the capacity of forecasting algorithms to “memorise” information and “learn” their effects. The chaotic behaviour can also be used to assist and improve the performance of traditional techniques for feature selection such as principal component analysis. As chaos theory can detect sensitivity to the initial conditions governing the dynamics of the system in a time-related way and can precisely determine the time delay and embedding dimension, it provides a more realistic, efficient and unbiased guideline to select the key features driving the long-term behaviour of prices for forecasting. The finding of chaotic-time related behaviour in mineral commodity prices may also assist in the selection of a more suitable algorithm for forecasting prices, as the algorithm should match the nature of the system. In the case of forecasting mineral commodity prices, the algorithm should be able to mimic the evolutive and time-related nature of human decision-making process, where the concept drift through the perceptron learner appears to be the more suitable technique.
We observed that four λ calculated based on the embedded parameters of the systems have positive values and statistical significance at 95% confidence interval. Thereby, we find sensitivity to the initial condition in annual copper prices, suggesting chaotic behaviour. This finding is particularly important because of the debate on the adequacy of stochastic and econometric models for representing mineral commodity market behaviour (Mandelbrot, 1963; Sanei, 2013; Watkins and McAleer, 2004). Even though these models are considered as mathematically accurate and precise, they still have some incompleteness. Stochastic models have low probability of similarities and their predictability (which is depicted by their high Entropy) do not represent the time-related behaviour of copper prices. On the other hand, econometric models have a lack of evolutive time-related features of human cognition which is required for decision-making in the economic environment, and it is also unclear how their key variables are selected. Our assertion, through SampEn values, is that copper prices have similar patterns with well-known chaotic systems (Logistic Map). Hence, we can state the long-term copper prices time series was not generated by stochastic processes and does not exhibit periodic behaviour. Finally, we find a single long-term state of low prices only interrupted by periods of high demand lasting four or 5 years which challenges the assertion that metal prices have fluctuated over four major super cycles during the last 150 years (Cuddington and Jerrett, 2008; Jerrett and Cuddington, 2008; Rossen, 2015), at least for copper.
The assessment of the dynamics of small data series requires rigorous and combined visual and numerical analysis to identify the patterns which govern the system and the parameters which describe it. A joint numerical and visual analysis is vital to discard any result that seems to be consistent in theory but is incorrect in practice.
The datasets analysed during the current study are available in the Dataverse repository: http://doi.org/10.7910/DVN/VGBHTQ.
These datasets were derived from the following public domain resources:
https://www.cochilco.cl/Paginas/English/Home.aspx; https://fred.stlouisfed.org/series/PPIACO and from Takeuchi et al. (1987).
We use a single dataset of annual copper prices, acquired from the World Bank (Takeuchi et al., 1987) (1990–1934) and from the Chilean Copper Corporation (Cochilco) (Comision Chilena del Cobre de Chile, 2017) (1935–2015). Our original dataset consists in 116 observations corresponding to annual constant (2012 = 100) refined copper prices quoted in the LME between 1900 and 2015. Observation values are quoted in the U.S. Dollar per pound of metallic copper (USD cents/lb) (See the Supplementary Table 4 for details).
We reconstruct the phase space by using the delay embedding theorem of Takens (Takens, 1981). It asserts that if the qualitative features of the phase space are reconstructed using a time delay it is possible to obtain the information of the original system from the evolution of the variables (Eq. 1). Here τ represents the embedding delay and m represents the embedding dimension (Huke, 2006; Perc, 2006; Povinelli, 2001; Takens, 1981).
Although the literature suggests several theorems to narrow the search for an appropriate combination of τ and m (Huffaker, 2010), the heuristic approach provided by the visual analysis of delay plots is a useful and simple method.
We perform three unit root tests to verify stationarity. For the Augmented Dickey–Fuller test, we use a regression model based on the first-differenced series \(y^{\prime}_t\left( {y^{\prime}_t = y_t - y_{t - 1}} \right)\) that includes several lags represented by (k) where the coefficient ø = 0 if \(y^{\prime}_t\) is stationary (Eq. 2). For the Phillips–Perron test, we use a regression test where u
t
 is the alternative null hypothesis (H1) and may be heteroskedastic (Zivot and Wang, 2007) (Eq. 3). For the Kwiatkowski–Phillips–Schmidt–Shin test, we break the time series into stationarity and random walk components (Hyndman and Athanasopoulos, 2013; Panas, 2001) (Eq. 4 and 5). Here D
t
 contains deterministic components, u
t
 corresponds to H0 and μt is a pure random walk process with variance \(\sigma _{\it{\epsilon }}^2\). We test the score statistic \(\sigma _{\it{\epsilon }}^2{\mathrm{ = }}0\) against the alternative that \(\sigma _{\it{\epsilon }}^2{\mathrm{ > }}0\) (Eq. 6) (Zivot and Wang, 2007).
We use a method (Kaplan, 1994) (Eq. 7–9) that can be used to assess very small datasets with low dimension and large λ, as well as moderate dimension (≈7) noisy systems. We examine the possible continuity of the orbits contained in the reconstructed phase space in three stages. Firstly, we create a set of surrogate data. Then, we calculate an appropriate E-statistic for τ embedding the original time-series and the surrogates. Finally, we analyse the deterministic structure of the time series by calculating the cumulative sum over the Bin average (e(r)) and compare with the E-statistics (Eq. 10).
Here δ
j,k
 is the Euclidian distance between phase space points (z
j
−z
k
), k is the global orbital lag, ∈
j,k
 is the separation distance between(k) future points measured along an orbit, Δr is the width increments of Euclidian size. Deterministic signals are recognised by a noticeable separation of E-statistic between the original time series and the set of surrogate data (Constantine and Percival, 2016; Kaplan, 1994). Determinism level percentage is calculated by using the overlapping fraction between the E-statistics of the original series and the ensemble of surrogates (Supplementary Fig. 1).
We also use the false nearest neighbours method developed by Cao (1997) that allows testing the deterministic characteristics of the system along with determining m (Supplementary Fig. 5c). We use the function E2(d) (Eq. 11–12) to distinguish between deterministic and stochastic signals. While stochastic signals exhibit invariant E2(d)values, approximate to 1, for all values of m, in deterministic signals E2(d) values fluctuate and move away from 1 E2(d)≠1 (Cao, 1997).
Here N denotes the length of the time series and x
n(i,d)+dτ
 the time delay reconstructed vectors.
For testing entropy, four additional datasets were used. Two random data sets were generated rearranging copper price sequences of the original dataset. The proven Logistic Map (Eq. 13) was used to generate periodic (α = 3.4) and chaotic (α = 4) signals (Yentes et al., 2013). In Eq. 13, x
n
 is a real number and the rate of grow of decay is represented by α.
ApEn and SampEn algorithms are based in three parameters so called length of the data segment being compared (µ), similarity criterion (r), and data length (N) (Yentes et al., 2013). ApEn measures the conditional probability that in two similar sequences samples embedded in a dimension µ remain similar in the next sample µ + 1 within a threshold tolerance r (Eq. 14) (Chen et al., 2006; Pincus, 1995, 1991). SampEn is the negative natural logarithm of the conditional probability that a series of data points separated by a distance µ would repeat itself at µ + 1, without counting self-matches in a dataset of length N (Eq. 15) (Chen et al. 2006; Lake et al., 2002; Richman and Moorman, 2000; Yentes et al., 2013). Given a set of N data points {u(i)}, a vector sequence x(1) to x(N−μ+1) by \(x\left( i \right) = \left[ {u\left( i \right), \cdots ,u\left( {i + \mu - 1} \right)} \right]\). The maximum distance between vectors x(i) and x(j) is defined as \(d\left[ {x\left( i \right),\,x\left( j \right)} \right] = max\left[ {\left| {x\left( {i + k} \right) - x\left( {j + k} \right)} \right|} \right]\) for 0 ≤ k ≤ μ−1.
ApEn is defined as. For each \(i \le N - \mu + 1,C_r^\mu \left( i \right) = \left( {V^\mu \left( i \right)} \right)/\left( {N - \mu + 1} \right)\), where Vμ = number of \(j \le N - \mu + 1\) such that \(d\left[ {x\left( i \right),x\left( j \right)} \right] \le r.\phi ^\mu \left( r \right) = \left( {N - \mu + 1} \right)^{ - 1}\mathop {\sum}\nolimits_{i = 1}^{N - \mu + 1} {{\mathrm{ln}}C_i^\mu \left( r \right)}\).
SampEn is defined as. For each \(1 \le i \le N - 1,B_i^\mu \left( r \right) = \left( {N - \mu + 1} \right)^{ - 1} \times No.\,of\,d_\mu \left[ {x\left( i \right),x\left( j \right)} \right] \le r,i \ne j\). For each \(\begin{array}{cc}1 \le i \le N - \mu ,A_i^\mu \left( r \right) = \left( {N-\mu + 1} \right)^{ - 1} \times No.\,of\,d_{\mu + 1}\left[ {x\left( i \right), x\left( j \right)} \right] \le r,i \ne j.\\ B^\mu \left( r \right) = (N - \mu )^{ - 1}\mathop {\sum}\nolimits_{i = 1}^{N - \mu } {B_i^\mu \left( r \right)}\end{array}\) and \(A^\mu \left( r \right) = \left( {N - \mu } \right)^{ - 1}\mathop {\sum}\nolimits_{i = 1}^{N - \mu } {A_i^\mu (r)}\).
Low similarity probability demonstrates the low predictability of the system; therefore, stochastic behaviour is presumed, which is enunciated by large ApEn values that trend toward infinity in the case of SampEn (Castiglioni and Di Rienzo, 2008; Lake et al., 2002; Pincus, 1995, 1991; Sarlabous et al., 2010; Yentes et al., 2013). High probability reflects repetitive patterns demonstrating a more predictable or regular system enunciated by small values of both ApEn and SampEn (Pincus, 2001; Pukthuanthong and Roll, 2011; Sarlabous et al., 2010; Yentes et al., 2013). Chaotic signals are presumed at intermediate values (Yentes et al., 2013) (Supplementary Table 5). We determine parameters r and µ based on the guidelines provided by Castiglioni and Di Rienzo (2008), Lu et al. (2008) and Yentes et al. (2013). Then, obtained parameters were used for testing ApEn and SampEn algorithms in the five data sets, entropies were compared and data sets process characterised according algorithms definitions (Castiglioni and Di Rienzo, 2008; Chen et al., 2006; Ferrario et al., 2006; Lake et al., 2002; Pincus, 1995, 1991; Sarlabous et al., 2010; Yentes et al., 2013).
We chose τ through the average mutual information (AMI) method and use a visual analysis to corroborate the results (Fig. 1b). The AMI method show us the amount of information that a time series at the time (t + Δt) may learn from another time series at the time (t) at given τ (Huffaker, 2010). If two vectors v
s
 and v
n
 are independent, the mutual information between them should not significantly diverge from one, and zero bits of information are shared (Collins and Turvey, 1999). Hence, the average mutual information informs us of the joint probability that x(t) is a bin of n and that x(t + τ) is a bin of s where the first minimum between two time series reveals the bottom threshold for choosing the optimum value of τ (Eq. 16) (Hegger et al. 1999; Kumar et al., 2004; Perc, 2006). Values above the average mutual information drops sharply (first minimum) are considered good candidates for τ (Hegger et al., 1999; Kumar et al., 2004; Perc, 2006; Sanei, 2013). We calculate AMI setting the maximum time lag at six (Ahrens and Sharma, 1997).
Here 
pi
 represents the probability of finding a time series in the i-th interval and 
pi,j
(t) the joint probability that an observation falls into the i-th interval and then observation at time τ falls into the j-th interval.
We determine m by using the false nearest neighbours method (Hegger et al., 1999; Kennel et al., 1992). We choose a sufficiently large, but minimum m capable of containing the reconstructed attractor (Huffaker, 2010; Kumar et al., 2004) assuring that the nearest neighbour of each reconstructed vector in the n-dimensional space must be found with respect to any metric. Thus, neighbours should be inside a sphere of radius (r) smaller than the diameter of the reconstructed attractor (d) and the number of neighbour candidates (Γ(r)) should be greater than 1 (Eq. 17–19) (Kennel et al., 1992; Kumar et al., 2004; Rosenstein et al., 1993). Here D is the dimension of the attractor and N the number of observations or data points (size of the dataset).
Next recognise that
thus,
We use the space-time separation plot (Provenzale et al., 1992) to identify the value of ω. We examine the manner in which closer points converge at given Δt separation. As scatter points are difficult to interpret, we use the contour map plots for plotting the fraction of points closer than a distance (δ) and separated by a given time Δt, as a function of Δt in a probabilistic approach (Eq. 20) (Provenzale et al., 1992).
In the contour map plot, the axis x shows the temporal separation Δt and the axis y shows the separation in space represented by the different curves that correspond to the different fractions, which correspond to the fractions of points closer than a distance (φ) at a given separation time Δt (Hegger et al., 1999). In chaotic systems, the contour map plot shows a characteristic and persistent pattern in the long-term structure that reflects its memory to initial conditions. The correlation decays through time and the different fractions converge to a particular Δt at constant Δt (Provenzale et al., 1992).
We measure the divergence (δ(t)), both global and local, between two close states or trajectories starting from a very close initial starting point (Eq. 21) (Cvitanović et al., 2013; Savi, 2005). Here x0 denotes the initial state, \(\delta _{x_0}\) the very close neighbourhood of the trajectory x0 and δ the infinitesimal difference in the time space.
We assess the sensitivity of the system to initial conditions by measuring the mean rate of separation of the trajectories between both states (Eq. 22) where two trajectories cannot separate further than the size of the attractor (Cvitanović et al., 2013; Kantz and Schreiber, 2004). Observing that, in a finite time, the mutual separation increases exponentially through time until reaching the size of the accessible state space, we detect evidence of the existence of a strange attractor; therefore, a signal of chaotic behaviour (Supplementary Fig. 4).
We determine chaotic behaviour based on a method that allows us to use small noise datasets to calculate λ accurately by using the least-square fit to the average line (Rosenstein et al., 1993) (Eq. 23).
Here 〈In d
j
(i)〉 denotes the average over all values of j, and d
j
(i) denotes the divergence between trajectories over all values of j.
We validate chaotic behaviour by reconstructing the dynamic of the systems using the 'ln(divergence)' vs. time plot (Rosenstein et al., 1993) (Fig. 3). We plot the number of iterations Δt in the x axis vs. the natural logarithm of error divergence 〈In d
j
(i)〉 in the y axis where each slope of lines is proportional to λ.
We investigate the nonlinear behaviour of the time series using a surrogate analysis developed by Theiler et al. (1992) that has been largely used to assess and confirm the chaotic behaviour from experimental data (Das and Das, 2007; Raffalt et al., 2017; So et al., 1996; Theiler and Prichard, 1997).
Surrogates were created using the Amplitude adjusted Fourier transform algorithm (Theiler et al., 1992). The statistical significance of surrogates was determined by measuring the difference between the statistics of the original times series (Q
D
) and the mean of surrogates (v
H
) divided by their standard deviation (σH). This is a dimensionless quantity (Eq. 24). Then, ρ-values where calculated using the complementary error function (Eq. 25). The null hypothesis state that statistical obtained from the original time series are equal to those obtained for the surrogates and is rejected at low ρ-values (ρ-values ≤ 0.05).
