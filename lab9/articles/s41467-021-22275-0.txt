Jordan products of quantum channels and their compatibility
#https://www.nature.com/articles/s41467-021-22275-0
Given two quantum channels, we examine the task of determining whether they are compatible—meaning that one can perform both channels simultaneously but, in the future, choose exactly one channel whose output is desired (while forfeiting the output of the other channel). Here, we present several results concerning this task. First, we show it is equivalent to the quantum state marginal problem, i.e., every quantum state marginal problem can be recast as the compatibility of two channels, and vice versa. Second, we show that compatible measure-and-prepare channels (i.e., entanglement-breaking channels) do not necessarily have a measure-and-prepare compatibilizing channel. Third, we extend the notion of the Jordan product of matrices to quantum channels and present sufficient conditions for channel compatibility. These Jordan products and their generalizations might be of independent interest. Last, we formulate the different notions of compatibility as semidefinite programs and numerically test when families of partially dephasing-depolarizing channels are compatible.
There are several different settings for the compatibility of states, measurements, and channels that are considered in this paper. The interested reader is referred to the reviews in refs. 1,2,3,4 for further discussions on these topics.
The quantum state marginal problem 5,6,7,8 is one of the most fundamental problems in quantum theory and quantum chemistry. One version of this problem is the following problem. Given a collection of systems \({{\mathcal{X}}}_{1},\ldots ,{{\mathcal{X}}}_{n}\) and a collection of density operators ρ1, …, ρm—each acting on some respective subset of subsystems \({S}_{1},\ldots ,{S}_{m}\subseteq {{\mathcal{X}}}_{1}\otimes \cdots \otimes {{\mathcal{X}}}_{n}\)—determine whether there exists a state ρ on \({{\mathcal{X}}}_{1}\otimes \cdots \otimes {{\mathcal{X}}}_{n}\) which is consistent with every density operator ρ1, …, ρm. For example, if ρ1 acts on S1, then ρ must satisfy
and similarly for the other states ρ2, …, ρm. This problem is nontrivial if the density operators act on overlapping systems and indeed is computationally expensive to determine, as the problem is known to be QMA-complete 9,10. Small instances of the problem can be solved (to some level of numerical precision), however, by solving the following semidefinite programming feasibility problem:
Note that the condition that ρ has unit trace is already enforced by the constraints. In the case where the systems \({{\mathcal{X}}}_{2}=\cdots ={{\mathcal{X}}}_{n}\) and density operators σ: = ρ2 = ⋯ = ρn are identical (where we omit ρ1 for indexing convenience), we remark that, for the choice of subsystems \({S}_{i}={{\mathcal{X}}}_{1}\otimes {{\mathcal{X}}}_{i}\) for each i ∈ {2, …, n}, one obtains the so-called (n − 1)-symmetric-extendibility condition for σ. This is closely related to separability testing 11.
There is an analogous task for quantum measurements called the measurement compatibility problem (see 12,13 for POVMs (positive operator-valued measures) and 14,15 for the special case of qubits). This task can be stated as follows. Two POVMs {M1, …, Mm} and {N1, …, Nn} are said to be compatible if there exists a choice of POVM {Pi,j: i ∈ {1, …, m}, j ∈ {1, …, n}} that satisfies
for each index i and j. In other words, the two measurements are a course-graining of the compatibilizing measurement {Pi,j}. It may seem at first glance that both measurements are being performed simultaneously, but this view is incorrect. Performing a compatibilizing measurement should be viewed as performing a separate measurement which captures the probabilities of both measurements simultaneously. Although measurement compatibility is defined mathematically, it also has operational applications—for example, incompatible measurements are necessary for quantum steering 16,17,18 and Bell nonlocality 19,20,21.
Determining the compatibility of the two POVMs above can be solved via the following semidefinite programming feasibility problem:
where the POVMs each act on some system \({\mathcal{X}}\). Note that the condition \(\mathop{\sum }\nolimits_{i = 1}^{m}\mathop{\sum }\nolimits_{j = 1}^{n}{P}_{i,j}={{\mathbb{1}}}_{{\mathcal{X}}}\) is enforced by the constraints and thus every collection of operators satisfying the conditions in Eq. (4) necessarily composes a POVM. The semidefinite programming formulation provided above may also be used to certify incompatibility by using notions of duality, i.e., to provide an incompatibility witness 22,23.
This notion of compatibility for measurements generalizes the concept for commuting measurements. Indeed, if [Mi, Nj] = 0 holds for each choice of indices i and j then the measurement operators Pi,j defined as Pi,j = MiNj form a compatibilizing POVM. This does not hold generally, as the operators MiNj need not even be Hermitian if Mi and Nj do not commute. Nevertheless, one can study Hermitian versions of these matrices using Jordan products, as is discussed below.
The Jordan product of two square operators A and B is defined as
This is Hermitian whenever both A and B are Hermitian. The Jordan product can be used to study the compatibility of measurements (see 24,25). In particular, for POVMs {M1, …, Mm} and {N1, …, Nn}, note that the operators defined as
satisfy
for each choice of indices i and j. Thus, if Mi ⊙ Nj is positive semidefinite for each i and j then the POVM defined in Eq. (6) is a compatibilizing measurement. It is known that if either {M1, …, Mm} or {N1, …, Nn} are projection-valued measures (PVMs), i.e., if either \({M}_{i}^{2}={M}_{i}\) for all i ∈ {1, …, m} or \({N}_{j}^{2}={N}_{j}\) for all j ∈ {1, …, n}, then they are compatible if and only if each of the Jordan product operators Mi ⊙ Nj is positive semidefinite 26. It is also known that for POVMs, positive semidefinitiveness of Mi ⊙ Nj is not sufficient for their compatibility 24.
Before discussing the quantum channel marginal problem, we take a slight detour and discuss the no-broadcasting theorem. A quantum broadcaster for a quantum state \(\sigma \in {\rm{Pos}}({\mathcal{X}}\otimes {\mathcal{Y}})\) is a channel that acts on the \({\mathcal{X}}\) subsystem of σ and outputs a state \(\rho \in {\rm{Pos}}({{\mathcal{X}}}_{1}\otimes {{\mathcal{X}}}_{2}\otimes {\mathcal{Y}})\) that satisfies
where \({\mathcal{X}}={{\mathcal{X}}}_{1}={{\mathcal{X}}}_{2}\). In other words, one applies the channel that broadcasts σ and decides afterwards where σ is to be localized. One can show—when there is no promise on the input σ—that such a channel cannot exist due to the existence of noncommuting quantum states 27. An easy way to see this is by trying to broadcast half of an EPR state, which would violate monogamy of entanglement. This proves the well-known no-broadcasting theorem, which states that a perfect broadcasting channel cannot exist. (The question of determining the best “noisy” broadcasting channel has also been investigated 28,29,30). One may notice that the conditions above imposed by broadcasting is a special case of the quantum state marginal problem (for fixed input σ) and, moreover, of the symmetric-extendibility problem as described above (for which it is sometimes the case that no solution exists).
The task of determining compatibility of quantum channels, which has been studied recently (see, e.g. 31,32,33,34,35), can be stated as follows. Given two quantum channels, Φ1 from \({\mathcal{X}}\) to \({{\mathcal{Y}}}_{1}\) and Φ2 from \({\mathcal{X}}\) to \({{\mathcal{Y}}}_{2}\), one determines if there exists another channel Φ from \({\mathcal{X}}\) to \({{\mathcal{Y}}}_{1}\otimes {{\mathcal{Y}}}_{2}\) that satisfies
for every input X. The notion of broadcasting (as defined in the previous paragraph) is a specific instance of this problem, where one chooses both Φ1 and Φ2 to be the identity channel. One may express channel compatibility as a convex feasibility problem over the space of linear maps:
The condition that Φ is trace-preserving follows from the constraints. The channel compatibility problem (in either the no-broadcasting formulation or in the general form given in Eq. (10)) is an essential component of research in quantum cryptography. For example, if two parties, say Alice and Bob, decide to communicate via some channel Φ1, an eavesdropper Eve may use any channel Φ2 compatible with Φ1 to obtain partial information about the communication between Alice and Bob.
To see how the channel and state versions of the marginal problem are generalizations of each other, we may consider the Choi representations of the channels. It is not hard to see 32,36 that the conditions for the compatibility of Φ1 and Φ2 is equivalent to the following conditions on the Choi matrices:
where J(Φ1) and J(Φ2) are the Choi representations of these channels. In other words, the channels are compatible if and only if the normalized Choi matrices are compatible as states.
To see how the channel compatibility problem is a generalization of the measurement compatibility problem, consider the following reduction. For the POVMs {M1, …, Mm} and {N1, …, Nn}, define the channels
where Ei,i is the density matrix of the ith computational basis state; one may also think of Ei,i as \(\left|i\right\rangle \!\! \left\langle i\right|\) in Dirac notation. Channels of this form are known as measure-and-prepare (or, equivalently, as entanglement-breaking) channels. It is easy to see that the POVMs {M1, …, Mm} and {N1, …, Nn} are compatible if and only if ΦM and ΦN are compatible as channels.
The result above also holds in more general settings. In particular, a similar result holds for measure-and-prepare channels in the case when the choice of state preparations are distinguishable. However, if the preparations are chosen in a general way, then this equivalence breaks down. To be precise, consider the channels defined as
for some density operators ρ1, …, ρn and σ1, …, σm. One can show that \({{{\Psi }}}_{M}\) and \({{{\Psi }}}_{N}\) are compatible if the POVMs {M1, …, Mm} and {N1, …, Nn} are compatible (but the converse may not be true).
Another notion of channel compatibility that we consider in this paper concerns the case when Φ1 = Φ2 = Φ for some fixed channel Φ (i.e., when the channels are the same). A channel Φ that is compatible with itself is said to be self-compatible.
One may also consider—for some other positive integer k > 2—whether some choice of k channels Φ1, …, Φk are compatible. If k copies of some fixed channel are compatible—i.e., Φ1 = ⋯ = Φk = Φ are all equal to some fixed channel Φ—then we say that Φ is k-self-compatible.
In this work, we prove several results about channel compatibility. First, we show that the channel compatibility problem is equivalent to the quantum state marginal problem, i.e., every quantum state marginal problem can be recast as the compatibility of two channels, and vice versa. Second, we show that compatible measure-and-prepare channels (i.e., entanglement-breaking channels) do not necessarily have a measure-and-prepare compatibilizing channel. Third, we extend the notion of the Jordan product of matrices to quantum channels and present sufficient conditions for channel compatibility. These Jordan products and their generalizations might be of independent interest. Lastly, we formulate the different notions of compatibility as semidefinite programs and numerically test when families of partially dephasing-depolarizing channels are compatible.
We examine the quantum channel marginal/compatibility problem using several different perspectives. Here we provide an overview of our results, which are stated in an informal manner. Precise definitions and theorem statements can be found in Supplementary information.
As is remarked above, the compatibility of channels is equivalent to the compatibility of their normalized Choi representations as quantum states. That is, the problem of determining the compatibility of channels can be reduced to solving the state marginal problem for a certain choice of states. We show that the quantum channel marginal problem also generalizes the state marginal problem. Recently, a somewhat weaker version of this result was proved in 36, where it was shown that the marginal problem for quantum states with invertible marginals is equivalent to the compatibility of channels. By using a different method to prove the result, we bypass the need for invertible marginals.
Result 1 (Informal, see Supplementary Note 2 for a formal statement.) Every quantum state marginal problem is equivalent to the compatibility of a particular choice of quantum channels.
We first note that every measure-and-prepare (i.e., entanglement-breaking) channel is self-compatible. Indeed, for measure-and-prepare channel Φ there exists a POVM {M1, …, Mm} and a collection of density matrices ρ1, …, ρn such that
for all X. Now consider the channel
This channel clearly compatibilizes two copies of Φ. (Moreover, one can easily modify Ψ above such that it compatibilizes k copies of Φ. Hence every measure-and-prepare channel is also k-self-compatible for all k.)
The task of determining whether two distinct measure-and-prepare channels Φ1 and Φ2 are compatible, however, is not so straightforward. From the discussion in the previous paragraph, if Φ1 and Φ2 are expressed as measure-and-prepare channels such that the prepared states are distinct computational basis states, it can be seen that the notion of channel compatibility is equivalent to that of measurement compatibility. However, this is not the case for all measure-and-prepare channels. For instance, there may be multiple ways to express the measurements and/or preparations for a particular measure-and-prepare channel. One might guess that any channel which compatibilizes two measure-and-prepare channels must also be measure-and-prepare and can only exist if all three sets of measurements satisfy some conditions. However, we show that this is not the case, as described below. Note that similar result was also recently obtained in a different context in 37.
Result 2 (See Supplementary Note 3 for details.) There exists a pair of compatible measure-and-prepare channels with no measure-and-prepare compatibilizer.
The two channels were found using semidefinite programming formulations of channel compatibility and the notion of positive partial transpose (PPT).
The Jordan product of two channels, Φ1 from system \({\mathcal{X}}\) to system \({{\mathcal{Y}}}_{1}\) and Φ2 from \({\mathcal{X}}\) to \({{\mathcal{Y}}}_{2}\), is the linear map Φ1 ⊙ Φ2 from the system \({\mathcal{X}}\) to the system \({{\mathcal{Y}}}_{1}\otimes {{\mathcal{Y}}}_{2}\) whose Choi representation is given by
where Ei,j is the matrix whose (i, j)-entry is 1 and has zeros elsewhere, i.e., one can also think of Ei,j as \(\left|i\right\rangle \left\langle j\right|\) in Dirac notation, and ⊙ on the right-hand side denotes the Jordan product of matrices as defined in Eq. (5). It is straightforward to see that the map Φ = Φ1 ⊙ Φ2 satisfies
for every choice of X. The map Φ1 ⊙ Φ2 might not be completely positive, as the corresponding Choi representation in Eq. (16) might not be positive semidefinite. However, if Φ1 ⊙ Φ2 is completely positive—and thus a channel, since it is trace-preserving by Eq. (17)—then this linear map is a compatibilizing channel for the channels Φ1 and Φ2. The condition that Φ1 ⊙ Φ2 be completely positive is therefore a sufficient condition for the channels Φ1 and Φ2 to be compatible. If Φ1 ⊙ Φ2 is not completely positive, one can use the lowest eigenvalue of the Choi matrix of Φ1 ⊙ Φ2 to estimate the amount of noise needed to add to the channels Φ1 and Φ2 to make them compatible. This amount of noise is closely related to the resource theory of compatibility and to the robustness of incompatibility of quantum channels 38. One may also use the equivalence of the channel compatibility and quantum marginal problems from Result 1 to apply the Jordan product to the quantum marginal problem.
It is known that for projection-valued measures (PVMs)—that is POVMs where every operator is a projection—the Jordan product provides a necessary and sufficient condition for the compatibility of a PVM with any POVM 26. It is therefore natural to consider whether the Jordan product of channels similarly provides necessary and sufficient conditions for a PVM-measurement channel to be compatible with another arbitrary channel. Namely, for a PVM {Π1, …, Πm}, let ΔΠ be the corresponding measurement channel defined as
for every choice of X. One may ask whether complete positivity of the Jordan product ΔΠ ⊙ Φ is always equivalent to the compatibility of ΔΠ and Φ, for any other choice of channel Φ. This is indeed the case, as described below.
Result 3 (Informal, see Supplementary Note 4 for a formal statement.) ΔΠ is compatible with Φ if and only if ΔΠ ⊙ Φ is completely positive.
To tackle more general cases, we describe how to relax the sufficient condition that the Jordan product be completely positive. Note that the Choi representation of the Jordan product as provided in Eq. (16) can be expressed as
where AJP is the Choi representation of the Jordan product of two identity channels. By replacing AJP in Eq. (19) with another matrix \(A\in {\rm{Herm}}({\mathcal{X}}\otimes {{\mathcal{X}}}_{1}\otimes {{\mathcal{X}}}_{2})\) satisfying
one obtains another linear map—which we denote by Φ1 ⊙ AΦ2. Each such matrix A provides another potential compatibilizing channel, so long as the corresponding map Φ1 ⊙ AΦ2 is completely positive. If there exists at least one choice of Hermitian matrix A satisfying Eq. (20) such that the map Φ1 ⊙ AΦ2 is completely positive, we say that the channels are Jordan compatible. What is surprising is that this sufficient condition is also necessary in most cases, as described in the following two results.
Result 4 (Informal, see Supplementary Note 4 for a formal statement.) If the channels Φ1 and Φ2 are invertible as linear maps, then they are compatible if and only if they are Jordan compatible. (Note that the inverses do not have to be quantum channels themselves.)
The requirement that both channels are invertible is not too restrictive, as indicated by the following result.
Result 5 (Informal, see Supplementary Note 5 for a formal statement.) The set of Jordan-compatible pairs of channels has full measure as a subset of all compatible pairs.
The task of determining whether two channels Φ1 and Φ2 are compatible can be formulated as the following semidefinite programming feasibility problem:
This formulation can be found by using the Choi representations of each channel and their compatibilizer (where X is the Choi representation of the desired compatibilizer).
The Jordan-compatibility of two channels can be similarly determined via the following semidefinite programming feasibility problem:
where AJP is the matrix as determined in the discussion around Eq. (19).
The formulation in Eq. (21) has the advantage of being linear in the Choi representations of the channels—one could therefore keep them as variables and impose affine constraints on the channels. As a concrete example, one may ask whether there exist two qubit-to-qubit channels that are compatible and both unital. (We know that two identity channels do not satisfy these two conditions, but an identity channel and a completely depolarizing channel does.)
We use duality theory to show a few theorems of the alternative for the cases of compatibility and Jordan compatibility. For an example, we present one of the two versions for compatibility, below.
Result 6 (Informal, see Supplementary Note 6 for a formal statement.) Φ1 and Φ2 are compatible if and only if there does not exist Z1 and Z2 such that
(Note that we define formally what the adjoint of the partial trace is later, but for now it can simply be viewed as a linear map.)
We test various notions of compatibility for certain classes of qubit-to-qubit channels using the semidefinite programming formulations shown above. The family of channels that we consider are the partially dephasing-depolarizing channels defined as
for parameters p, q ∈ [0, 1]. Here \({{\mathbb{1}}}_{{\rm{L}}({\mathcal{X}})}\) is the identity channel, Δ is the completely dephasing channel, and Ω is the completely depolarizing channel, which are defined by the equations
holding for all operators X, where \({{\mathbb{1}}}_{{\mathcal{X}}}\) is the identity matrix.
We investigate the values (p, q) ∈ [0, 1] × [0, 1] for which the channel Ξp,q is k-self-compatible for k ∈ {1, …, 10} ∪ {∞}. (Recall that the condition that Ξp,q is measure-and-prepare is equivalent to the condition that it is k-self-compatible for all k.)
We also examine the values of (p, q) ∈ [0, 1] × [0, 1] for which Ξp,q ⊙ Ξp,q is completely positive. This region turns out to be marginally smaller than the region where Ξp,q is self-compatible, thus reinforcing the need for our generalization of the Jordan product. In fact, the channel Ξp,q is invertible when p, q > 0 satisfies p + q < 1, so self-compatibility for this channel can be examined using (generalized) Jordan products for almost all values of p and q.
Finally, we investigate the region of values (q0, q1) ∈ [0, 1] × [0, 1] for which the pairs of channels \(({{{\Xi }}}_{0,{q}_{0}},{{{\Xi }}}_{0,{q}_{1}})=({{{\Omega }}}_{{q}_{0}},{{{\Omega }}}_{{q}_{1}})\) are compatible and when the Jordan product \({{{\Omega }}}_{{q}_{0}}\odot {{{\Omega }}}_{{q}_{1}}\) is completely positive. It turns out that the values of (q0, q1) for which \({{{\Omega }}}_{{q}_{0}}\odot {{{\Omega }}}_{{q}_{1}}\) is completely positive contains some nontrivial instances while simultaneously missing other trivial instances of compatible pairs. This illustrates that the (standard) Jordan product provides an interesting sufficient condition for compatibility.
In this work, we studied the quantum channel marginal problem (i.e., the channel compatibility problem)—which is the task of determining whether two channels can be executed simultaneously, in the sense that afterwards, one can choose which channel’s output to obtain. We showed how to decide this via semidefinite programming and presented several other key properties such as its equivalence to the quantum state marginal problem.
We also studied a generalization of the Jordan product to quantum channels, and in turn, generalized it further such that it captures the compatibility of invertible channels. This Jordan product may be of independent interest.
There are many open problems concerning the compatibility of channels. We briefly mention a few which we think are interesting.
One immediate open problem is the question of whether compatibility and Jordan compatibility are equivalent. We conjecture that they are equivalent based on the fact that the set of pairs of compatible channels that are not Jordan compatible must have zero measure when the output and input spaces have the same dimension. On this note, it would be interesting to see if the resolution to this conjecture depends on the dimensions of the input and output spaces.
Another interesting problem is to examine the computational complexity of determining compatibility for a given pair of channels. Since it is equivalent to the quantum state marginal problem, we suspect that there are versions of this problem which are QMA-hard (although the equivalence is a mathematical one, and may or may not translate into efficient algorithmic reductions).
Another open problem is whether one can extend this work to study the compatibility of other quantum objects, such as quantum strategies 39,40,41, combs 42,43, or even channels in other generalized probabilistic theories.
Lastly, there might be a relationship between channel compatibility and cryptography. For example, symmetric extendibility is closely related to quantum key distribution, since you do not want Alice to be just as correlated/entangled with Bob and she is with Eve. Since quantum channel compatibility generalizes symmetric extendibility, perhaps there is another cryptographic setting in which the notion of channel compatibility translates into (in)security.
